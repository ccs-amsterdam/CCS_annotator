(this.webpackJsonpamcat4annotator=this.webpackJsonpamcat4annotator||[]).push([[0],{251:function(e,t){},253:function(e,t){},282:function(e,t,n){var r={"./bg-BG.json":283,"./ca-ES.json":284,"./cs-CZ.json":285,"./de-DE.json":286,"./en-US.json":193,"./es-ES.json":287,"./et-EE.json":288,"./fi-FI.json":289,"./fr-FR.json":290,"./he-IL.json":291,"./it-IT.json":292,"./ja-JP.json":293,"./ko-KR.json":294,"./nb-NO.json":295,"./nn-NO.json":296,"./pl-PL.json":297,"./pt-BR.json":298,"./ru-RU.json":299,"./sv-SE.json":300,"./tr-TR.json":301,"./zh-CN.json":302};function a(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}a.keys=function(){return Object.keys(r)},a.resolve=o,e.exports=a,a.id=282},304:function(e,t,n){},306:function(e,t,n){"use strict";n.r(t);n(229);var r=n(0),a=n.n(r),o=n(52),c=n.n(o),i=n(79),s=n(16),u=n(335),l=n(15),d=n(7),j=n.n(d),f=n(12),b=n(197),p=n(198),h=n(199),O=n(160),v=n.n(O),g=new(function(){function e(){Object(b.a)(this,e),this.idb=new h.a("AmCAT_Annotator"),this.idb.version(1).stores({meta:"welcome",apis:"api",codingjobs:"job_id, name",documents:"doc_id, job_id"})}return Object(p.a)(e,[{key:"welcome",value:function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.isWelcome();case 2:if(e.sent){e.next=4;break}this.idb.meta.add({welcome:1});case 4:return e.abrupt("return",null);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isWelcome",value:function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.idb.meta.get(1));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"addToken",value:function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.idb.apis.put({api:t,token:n.token,refresh_token:n.refresh_token,expiration_date:n.expiration_date}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteToken",value:function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.idb.apis.delete(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getToken",value:function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.idb.apis.get(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"createCodingjob",value:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=v()([t,Date.now().toString()]),this.idb.codingjobs.add({job_id:n,name:t}),e.abrupt("return",{job_id:n,name:t});case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteCodingjob",value:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.listDocuments(t);case 2:return n=e.sent,e.next=5,this.deleteDocuments(n);case 5:return e.abrupt("return",this.idb.codingjobs.delete(t.job_id));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listCodingjobs",value:function(){var e=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idb.codingjobs.toArray();case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getCodingjob",value:function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.idb.codingjobs.get(t.job_id));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"writeCodebook",value:function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.abrupt("return",this.idb.codingjobs.where("job_id").equals(t.job_id).modify({codebook:JSON.stringify(n,null,2)}));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createDocuments",value:function(){var e=Object(f.a)(j.a.mark((function e(t,n){var r,a,o,c,i,s=arguments;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],e.t0=Set,e.next=4,this.idb.documents.where("job_id").equals(t.job_id).primaryKeys();case 4:return e.t1=e.sent,a=new e.t0(e.t1),o=0,c=n.reduce((function(e,n){var r=v()([n,t]);if(a.has(r))o++;else{if(a.add(r),n.annotations&&n.annotations.length>0)try{JSON.parse(n.annotations)}catch(c){throw alert("Annotations field contains invalid JSON"),new Error("JSON parse error")}e.push(Object(l.a)({doc_id:r,job_id:t.job_id},n))}return e}),[]),r||(i="Created ".concat(n.length-o," new documents in codingjob ").concat(t.name,"."),o>0&&(i+=" Ignored ".concat(o," duplicates")),alert(i)),e.abrupt("return",this.idb.documents.bulkAdd(c));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteDocuments",value:function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return e.doc_id})),e.abrupt("return",this.idb.documents.bulkDelete(n));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listDocuments",value:function(){var e=Object(f.a)(j.a.mark((function e(t){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e,t){var n=[],r=1;return e.each((function(e){return n.push(Object(l.a)({doc:r++},t(e)))})).then((function(){return n}))},r=this.idb.documents.where("job_id").equals(t.job_id),e.abrupt("return",n(r,(function(e){return{doc_id:e.doc_id,title:e.title,annotations:e.annotations}})));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getDocument",value:function(){var e=Object(f.a)(j.a.mark((function e(t){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.idb.documents.get(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"writeAnnotations",value:function(){var e=Object(f.a)(j.a.mark((function e(t,n){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.idb.documents.where("doc_id").equals(t.doc_id).modify({annotations:JSON.stringify(n,null,2)}));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteDB",value:function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.idb.meta.clear();case 2:return e.next=4,this.idb.apis.clear();case 4:return e.next=6,this.idb.codingjobs.clear();case 6:return e.next=8,this.idb.documents.clear();case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}()),x=n(10),m=n(330),k=n(336),w=n(307),y=n(200),C=n(201),S=n.n(C),E=n(1);function T(e){var t=e.totalRows,n=e.completedRows;console.log("Progress: ".concat(n," of ").concat(t," rows completed"))}var R=function(){var e=Object(r.useState)(!1),t=Object(x.a)(e,2),n=t[0],a=t[1],o=function(){var e=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(y.a)(g.idb,{filter:function(e,t,n){return"codingjobs"===e||"documents"===e},prettyJson:!0,progressCallback:T});case 3:t=e.sent,S()(t,"AmCAT_Annotator.json"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(""+e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(m.a,{closeIcon:!0,open:n,trigger:Object(E.jsx)(u.a.Item,{icon:"download",name:"Download",style:{color:"lightgreen"}}),onClose:function(){return a(!1)},onOpen:function(){return a(!0)},children:[Object(E.jsx)(k.a,{icon:"download",content:"Download everything"}),Object(E.jsx)(m.a.Content,{children:Object(E.jsx)("p",{children:"Download all data as a single JSON dump"})}),Object(E.jsx)(m.a.Actions,{children:Object(E.jsx)(w.a,{primary:!0,onClick:o,children:"Download"})})]})},_=n(13),D=function(e){return{type:"BLOCK_EVENTS",payload:e}},N=function(e){return{type:"SELECT_CODINGJOB",payload:e}},A=function(e){return{type:"SET_CODINGJOBS",payload:e}},z=function(e){return{type:"SET_DOCUMENTS",payload:e}},I=function(e){return{type:"SET_CURRENT_TOKEN",payload:e}},L=function(e,t){return{type:"SET_TOKEN_SELECTION",index:e,add:t}},B=function(e,t){return{type:"TRIGGER_CODESELECTOR",from:e,index:t}},F=function(e){return{type:"TOGGLE_ANNOTATIONS",payload:e}},P=function(e){return{type:"SET_CODES",payload:e}},G=n(50),W=function(e){var t=e.homepage,n=Object(_.b)(),a=Object(r.useState)(!1),o=Object(x.a)(a,2),c=o[0],i=o[1],l=Object(s.g)(),d=function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.deleteDB();case 3:n({type:"RESET_DB"}),i(!1),l.push(t),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(E.jsxs)(m.a,{closeIcon:!0,open:c,trigger:Object(E.jsx)(u.a.Item,{icon:"rocket",name:"Reset",style:{color:"#d7a3a3"}}),onClose:function(){return i(!1)},onOpen:function(){return i(!0)},children:[Object(E.jsx)(k.a,{icon:"power off",content:"Reset Annotator Database"}),Object(E.jsx)(m.a.Content,{children:Object(E.jsx)("p",{children:"This will remove all document and annotation data from your browser. Any annotations that have not been saved/synchronized will be lost. Are you absolutely sure?"})}),Object(E.jsxs)(m.a.Actions,{children:[Object(E.jsxs)(w.a,{color:"red",onClick:function(){i(!1)},children:[Object(E.jsx)(G.a,{name:"remove"})," No"]}),Object(E.jsxs)(w.a,{color:"green",onClick:d,children:[Object(E.jsx)(G.a,{name:"checkmark"})," Yes"]})]})]})};function J(){return K.apply(this,arguments)}function K(){return(K=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:t=e.sent,e.t0=t,e.next="never"===e.t0?6:"persisted"===e.t0?8:"prompt"===e.t0?10:12;break;case 6:return console.log("Not possible to persist storage"),e.abrupt("break",13);case 8:return console.log("Successfully persisted storage silently"),e.abrupt("break",13);case 10:return console.log("Not persisted, but we may prompt user when we want to."),e.abrupt("break",13);case 12:console.log("compiler desperately wanted a default");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return U.apply(this,arguments)}function U(){return(U=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.storage;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=navigator.storage.persist;case 5:if(!e.t0){e.next=9;break}e.t1=navigator.storage.persist(),e.next=10;break;case 9:e.t1=void 0;case 10:return e.abrupt("return",e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return V.apply(this,arguments)}function V(){return(V=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.storage;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=navigator.storage.persisted;case 5:if(!e.t0){e.next=9;break}e.t1=navigator.storage.persisted(),e.next=10;break;case 9:e.t1=void 0;case 10:return e.abrupt("return",e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return Y.apply(this,arguments)}function Y(){return(Y=Object(f.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.storage&&navigator.storage.persisted){e.next=2;break}return e.abrupt("return","never");case 2:return e.next=4,navigator.storage.persisted();case 4:if(!e.sent){e.next=7;break}return e.abrupt("return","persisted");case 7:if(navigator.permissions&&navigator.permissions.query){e.next=9;break}return e.abrupt("return","prompt");case 9:return e.next=11,navigator.permissions.query({name:"persistent-storage"});case 11:if("granted"!==(t=e.sent).state){e.next=21;break}return e.next=15,navigator.storage.persist();case 15:if(!e.sent){e.next=20;break}return e.abrupt("return","persisted");case 20:throw new Error("Failed to persist");case 21:if("prompt"!==t.state){e.next=23;break}return e.abrupt("return","prompt");case 23:return e.abrupt("return","never");case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Z=function(){var e=Object(r.useState)(!1),t=Object(x.a)(e,2),n=t[0],a=t[1],o=Object(r.useState)(!1),c=Object(x.a)(o,2),i=c[0],s=c[1];Object(r.useEffect)((function(){i||H().then(s)}),[i]);var l=function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:return e.next=4,H();case 4:e.sent?(s(!0),alert("indexedDB set to persistent for AmCAT Annotator")):alert("Failed to set indexedDB to persistent");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i?null:Object(E.jsxs)(m.a,{closeIcon:!0,open:n,trigger:Object(E.jsx)(u.a.Item,{icon:"database",name:"Enable persitance",style:{color:"#d7a3a3"}}),onClose:function(){return a(!1)},onOpen:function(){return a(!0)},children:[Object(E.jsx)(k.a,{icon:"database",content:"Set database persistence"}),Object(E.jsxs)(m.a.Content,{children:[Object(E.jsx)("p",{children:"We did not have permission to automatically make the data storage for this website persistent. This means that the data could be removed automatically by your browser if it needs to free up space for another website. You can try to set this manually here, but not all browsers support this (yet)."}),Object(E.jsx)("p",{children:"If the database is not persistent the app can still be used, but you need to be more carefull in making sure that data is regularly backed up, either by manually downloading data or syncing with some backend (work in progress)."})]}),Object(E.jsx)(m.a.Actions,{children:Object(E.jsxs)(w.a,{onClick:l,children:[Object(E.jsx)(G.a,{name:"checkmark"})," Yes"]})})]})},$=Object(s.i)((function(e){var t=e.items,n=e.homepage,r=Object(s.h)(),a=t.map((function(e,t){return Object(E.jsx)(u.a.Item,{index:t,as:i.b,to:e.path,header:0===t,disabled:!g,active:e.path===r.pathname,children:e.label},"item-"+t)}));return Object(E.jsxs)(u.a,{fixed:"top",inverted:!0,children:[a,Object(E.jsxs)(u.a.Menu,{position:"right",children:[Object(E.jsx)(R,{}),Object(E.jsx)(Z,{}),Object(E.jsx)(W,{homepage:n})]})]})})),Q=n(326),X=n(325),ee=n(337),te=n(334),ne=[{code:"Mark Rutte",color:"#40a31f"},{code:"Sigrid Kaag",color:"#f2db5c"},{code:"Jesse Klaver"}],re=[{title:"GL en PvdA hebben goed gesprek met informateur, maar wantrouwen Rutte",text:'PvdA-leider Lilianne Ploumen en GroenLinks-leider Jesse Klaver hadden vrijdag een goed gesprek met informateur Herman Tjeenk Willink, zeiden ze zelf. De twee benadrukten dat, hoewel er inhoudelijke stappen zijn gezet, hun vertrouwen in VVD-leider Mark Rutte nog niet is hersteld.\n\n    Informateur Willink zette zich vrijdag aan zijn taak. Eerste punt op de agenda zijn gesprekken met de lijsttrekkers van de acht grootste partijen.\n    \n    Een week nadat een groot deel van de partijleiders bekendmaakte niet meer met Rutte verder te willen onderhandelen over een nieuwe coalitie, wordt gekeken waarover partijen het inhoudelijk eens zijn.\n    \n    "Het was een prettig gesprek langs de lijnen van de inhoud", zei PvdA-leider Lilianne Ploumen na afloop. Ze heeft haar zorgen over de ongelijkheid in Nederland en over de zorg gedeeld.\n    \n    Ook Jesse Klaver (GroenLinks), die een uur eerder op gesprek kwam bij de informateur, benadrukte dat het ging over de problemen die opgelost moeten worden.\n    \n    Situatie niet veranderd in een week\n\nWat betreft de positie ten opzichte van Rutte is echter niets veranderd. Vorige week ondertekenden Ploumen en Klaver net als alle andere oppositiepartijen een motie van wantrouwen, vanwege Ruttes betrokkenheid bij de notitie over CDA-Kamerlid Pieter Omtzigt.\n\n"Als het aan ons ligt, was Rutte geen premier meer", zei Ploumen. Hoe Tjeenk Willink dat gedeukte vertrouwen kan herstellen, weet ze niet. "We wachten de voorstellen van de informateur af."\n\n"De vertrouwensbreuk is niet hersteld na \xe9\xe9n gesprek met de fractievoorzitters", zei ook Klaver. "Mijn mening over Rutte is niet veranderd."\n\nSP\'er Lilian Marijnissen sprak zich al eerder expliciet uit tegen samenwerking met Rutte.\n\nDe partijleiders hekelen het gebrek aan openheid en transparantie waar Rutte in hun ogen voor staat. "Als je een fout maakt, dan moet je dat toegeven en er niet over liegen", zei Klaver. Ploumen: "Het probleem is dat Mark Rutte heeft gelogen. Wij hebben het vertrouwen in hem opgezegd."\n\nWat de vervolgstappen moeten zijn, laten ze volledig over aan Tjeenk Willink. "Ik ga geen lijstjes maken met wat er moet gebeuren", zei Ploumen.\n\nDe informateur ontvangt later op vrijdag nog de partijleiders Wopke Hoekstra (CDA) en Sigrid Kaag (D66), en Rutte zelf.\n\nTjeenk Willink denkt niet dat Rutte zomaar door kan\n\nTjeenk Willink suggereerde woensdag op een persconferentie dat hij Rutte niet per se een sta-in-de-weg voor een verandering van de bestuursstijl in Den Haag vindt. Toen daarover vervolgens berichten in de media verschenen, voelde de informateur zich vrijdag genoodzaakt die boodschap bij te sturen.\n\nDe conclusie dat Rutte geen belemmering vormt voor de formatie, kan hij niet voor zijn rekening nemen, luidt een schriftelijke verklaring.\n\nTjeenk Willink heeft namelijk ook de opdracht om te onderzoeken "of en zo ja onder welke voorwaarden er voldoende vertrouwen tussen partijen bestaat of weer kan ontstaan".'},{title:"CU-leider Segers vindt dat uitspraak over Rutte te veel op de man was gespeeld",text:'Partijleider Gert-Jan Segers van de ChristenUnie (CU) vindt dat hij te veel op de man heeft gespeeld door coalitiedeelname uit te sluiten als VVD-leider Mark Rutte opnieuw premier zou worden. Terugblikkend zegt hij dat het niet om \xe9\xe9n persoon moet gaan, maar om "een ongezonde politieke cultuur en een genadeloze overheid". Daar moet volgens hem verandering in komen, zo zei hij zaterdag tijdens een congres van de partij.\n\n    \n    Segers deed zijn uitspraak over Rutte na het debat over de notitie "functie elders" voor CDA-Kamerlid Pieter Omtzigt. Binnen de CU is verdeeldheid ontstaan over het besluit van de fractie, erkent Segers.\n    \n    Naast steun is er ook kritiek van veel leden, die zeggen dat hij "te veel op de man heeft gespeeld en te weinig de bal". "Te veel Rutte, te weinig ons allemaal. En als dat de perceptie van veel mensen is, dan moet ik me dat aantrekken", aldus Segers tijdens het congres.\n    \n    \n    Volgens de CU-leider staat "de politieke cultuur in Den Haag natuurlijk niet los van Mark Rutte, zeker niet".\n    \n    "Maar die oude cultuur staat of valt niet met \xe9\xe9n man. Ook wijzelf maken er deel van uit. Ik wil niet genadeloos zijn voor personen, maar ik wil wel hard en helder zijn over een cultuur die niet deugt en een genadeloze overheid. Daar moet \xe9cht een omslag in komen", zei Segers.\n    \n    \n    De ChristenUnie heeft vijf zetels in de Tweede Kamer. Op het congres werden vier oude Kamerleden uitgezwaaid en trad Ankie van Tatenhove aan als nieuwe partijvoorzitter.'}],ae=function(){var e=Object(f.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createCodingjob("Demo codingjob");case 3:return n=e.sent,e.next=6,t.createDocuments(n,re,!0);case 6:return e.next=8,t.writeCodebook(n,ne);case 8:return e.abrupt("return",null);case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),oe=function(e){var t=e.items,n=Object(s.g)(),a=function(){var e=Object(f.a)(j.a.mark((function e(r,a){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a){e.next=5;break}return e.next=3,g.isWelcome();case 3:if(e.sent){e.next=5;break}return e.abrupt("return",null);case 5:if(e.prev=5,!r){e.next=9;break}return e.next=9,ae(g);case 9:return e.next=11,g.welcome();case 11:return e.next=13,J();case 13:n.push(t[0].path),e.next=18;break;case 16:e.prev=16,e.t0=e.catch(5);case 18:case"end":return e.stop()}}),e,null,[[5,16]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){a(!1,!0)})),Object(E.jsx)(ee.a,{inverted:!0,textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(E.jsx)(ee.a.Column,{style:{maxWidth:450},children:Object(E.jsxs)(te.a,{style:{border:0},children:[Object(E.jsx)(k.a,{as:"h2",textAlign:"center",children:"Welcome to the AmCAT annotator"}),Object(E.jsx)("p",{children:"This is the (early development version of the) AmCAT annotator. The fact that you see this message means that you're either here for the first time, or your local annotation database was reset (by you or your browser)."}),Object(E.jsx)("p",{children:"The annotator stores your codingjobs and annotations on your local computer in your browser's IndexedDB. Your data will only actually touch the internet when you synchronize your data."}),Object(E.jsx)(w.a,{primary:!0,onClick:function(){return a(!0,!1)},children:"Yes, off course I trust you"})]})})})},ce=n(216),ie=function(e){var t=e.Component,n=e.homepage,a=Object(ce.a)(e,["Component","homepage"]),o=Object(r.useState)(!0),c=Object(x.a)(o,2),i=c[0],u=c[1],d=Object(r.useState)(!1),b=Object(x.a)(d,2),p=b[0],h=b[1];return function(){var e=Object(f.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.isWelcome();case 2:if(!e.sent){e.next=6;break}h(!0),e.next=7;break;case 6:h(!1);case 7:u(!1);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()(),Object(E.jsx)(s.b,Object(l.a)(Object(l.a)({},a),{},{render:function(e){return i?Object(E.jsx)("div",{children:"loading..."}):p?Object(E.jsx)(t,Object(l.a)(Object(l.a)({},a),e)):Object(E.jsx)(s.a,{to:n})}}))},se=n(111),ue=n(110),le=n(206),de=n(102),je=n(90),fe=n(341),be=n(106),pe=n(165),he=n(339),Oe=function(e){var t=e.preGlobalFilteredRows,n=e.globalFilter,r=e.setGlobalFilter,a=t&&t.length;return Object(E.jsx)("span",{children:Object(E.jsx)("input",{value:n||"",onChange:function(e){r(e.target.value||void 0)},placeholder:"Search ".concat(a," records..."),style:{border:"0"}})})},ve=function(e){var t=e.columns,n=e.data,a=e.selectedRow,o=e.setSelectedRow,c=e.width,i=void 0===c?null:c,s=e.defaultSize,u=void 0===s?15:s,d=e.sizeSelector,j=void 0!==d&&d,f=Object(r.useState)(a?a.ROW_ID:null),b=Object(x.a)(f,2),p=b[0],h=b[1],O=Object(ue.useTable)({columns:t,data:n,initialState:{pageSize:u,globalFilter:""}},ue.useGlobalFilter,ue.useSortBy,ue.usePagination),v=O.getTableProps,g=O.getTableBodyProps,m=O.headerGroups,k=O.prepareRow,w=O.page,y=O.pageCount,C=O.gotoPage,S=O.setPageSize,T=O.preGlobalFilteredRows,R=O.setGlobalFilter,_=O.state,D=_.pageIndex,N=_.globalFilter;Object(r.useEffect)((function(){h(a?a.ROW_ID:null)}),[a]);var A=function(e){return e.headers.map((function(e){return Object(E.jsxs)(le.a,Object(l.a)(Object(l.a)({className:e.headerClass},e.getHeaderProps(e.getSortByToggleProps())),{},{children:[e.render("Header"),Object(E.jsx)("span",{children:e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""})]}))}))};return 0===n.length?null:Object(E.jsxs)("div",{style:{width:i},children:[Object(E.jsx)(Oe,{preGlobalFilteredRows:T,globalFilter:N,setGlobalFilter:R}),Object(E.jsxs)(fe.a,Object(l.a)(Object(l.a)({unstackable:!0,striped:!0,fixed:!0,singleLine:!0,selectable:!0},v()),{},{children:[Object(E.jsx)(be.a,{children:m.map((function(e){return Object(E.jsx)(de.a,Object(l.a)(Object(l.a)({},e.getHeaderGroupProps()),{},{children:A(e)}))}))}),Object(E.jsx)(pe.a,Object(l.a)(Object(l.a)({},g()),{},{children:function(e){return e.map((function(e,t){return k(e),Object(E.jsx)(de.a,Object(l.a)(Object(l.a)({active:!!p&&p===e.id,onClick:function(){return function(e){p&&p===e.id?(o(null),h(null)):(o(Object(l.a)(Object(l.a)({},n[e.id]),{},{ROW_ID:e.id})),h(e.id))}(e)}},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(E.jsx)(je.a,Object(l.a)(Object(l.a)({title:e.value},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}(w)}))]})),j?Object(E.jsx)(se.a,{text:"show per page",options:[10,25,50,100,500].map((function(e){return{value:e,text:e}})),onChange:function(e,t){S(t.value)}}):null,Object(E.jsx)("div",{style:{marginTop:"3em",display:"flex",justifyContent:"flex-end"},children:n.length>u?Object(E.jsx)(he.a,{style:{border:"0"},size:"mini",firstItem:!1,lastItem:!1,nextItem:!1,prevItem:!1,boundaryRange:1,ellipsisItem:{content:Object(E.jsx)(G.a,{name:"ellipsis horizontal"}),icon:!0},activePage:D+1,totalPages:y,onPageChange:function(e,t){C(t.activePage-1)}}):null})]})},ge=n(328),xe=n(333),me=n(324),ke=function(){var e=Object(_.c)((function(e){return e.codingjobs})),t=Object(_.b)(),n=Object(r.useState)("inactive"),a=Object(x.a)(n,2),o=a[0],c=a[1],i=Object(r.useState)(""),s=Object(x.a)(i,2),u=s[0],l=s[1],d=function(){var e=Object(f.a)(j.a.mark((function e(n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),l(u.trim()),c("pending"),e.prev=3,e.next=6,g.createCodingjob(u);case 6:return e.next=8,g.listCodingjobs();case 8:r=e.sent,t(N(null)),t(A(r)),c("inactive"),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0),c("error");case 18:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}();return e?Object(E.jsxs)(m.a,{as:ge.a,trigger:Object(E.jsxs)(w.a,{children:[Object(E.jsx)(G.a,{name:"plus"}),"Create job"]}),onSubmit:function(e){return d(e)},open:"inactive"!==o,onClose:function(){return c("inactive")},onOpen:function(){l(""),c("awaiting input")},size:"tiny",children:[Object(E.jsx)(k.a,{icon:"pencil",content:"Create new Codingjob",as:"h2"}),Object(E.jsx)(m.a.Content,{children:Object(E.jsx)(ge.a.Group,{children:Object(E.jsx)(ge.a.Input,{width:12,label:"Name",required:!0,type:"text",value:u,onChange:function(e,t){c("awaiting input"),l(t.value)},placeholder:"Enter name"})})}),Object(E.jsxs)(m.a.Actions,{children:["error"===o?Object(E.jsx)("div",{children:"Could not create codingjob for a reason not yet covered in the error handling..."}):null,"pending"===o?Object(E.jsx)(xe.a,{active:!0,inverted:!0,children:Object(E.jsx)(me.a,{content:"Creating codingjob"})}):Object(E.jsx)(w.a,{type:"submit",color:"green",icon:"save",content:"Create"})]})]}):null},we=function(){var e=Object(_.c)((function(e){return e.codingjob})),t=Object(_.b)(),n=Object(r.useState)("inactive"),a=Object(x.a)(n,2),o=a[0],c=a[1],i=function(){var n=Object(f.a)(j.a.mark((function n(r){var a;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return c("pending"),n.prev=1,n.next=4,g.deleteCodingjob(e);case 4:return n.next=6,g.listCodingjobs();case 6:a=n.sent,t(N(null)),t(A(a)),c("inactive"),n.next=16;break;case 12:n.prev=12,n.t0=n.catch(1),console.log(n.t0),c("error");case 16:case"end":return n.stop()}}),n,null,[[1,12]])})));return function(e){return n.apply(this,arguments)}}();return e?Object(E.jsxs)(m.a,{closeIcon:!0,open:"inactive"!==o,trigger:Object(E.jsxs)(w.a,{name:"logout",children:[Object(E.jsx)(G.a,{name:"minus"})," Delete job"]}),onClose:function(){c("inactive")},onOpen:function(){c("awaiting input")},children:[Object(E.jsx)(k.a,{icon:"trash",content:"Delete codingjob ".concat(e.name)}),Object(E.jsx)(m.a.Content,{children:Object(E.jsx)("p",{children:"Do you really want to delete this codingjob?"})}),Object(E.jsxs)(m.a.Actions,{children:["error"===o?Object(E.jsx)("div",{children:"Could not delete codingjob for a reason not yet covered in the error handling..."}):null,"pending"===o?Object(E.jsx)(xe.a,{active:!0,inverted:!0,children:Object(E.jsx)(me.a,{content:"Creating codingjob"})}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)(w.a,{color:"red",onClick:function(){c("inactive")},children:[Object(E.jsx)(G.a,{name:"remove"})," No"]}),Object(E.jsxs)(w.a,{color:"green",onClick:i,children:[Object(E.jsx)(G.a,{name:"checkmark"})," Yes"]})]})]})]}):null},ye=function(){var e=Object(f.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.isWelcome()){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,g.listCodingjobs();case 5:(r=e.sent).length>0&&(t(A(r)),n(Object(l.a)(Object(l.a)({},r[0]),{},{ROW_ID:"0"}))),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Ce=function(){var e=Object(f.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(g.isWelcome()){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,g.listDocuments(t);case 5:r=e.sent,n(z(r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Se=function(e){var t,n=e.type,a=void 0===n?"table":n,o=Object(_.c)((function(e){return e.codingjobs})),c=Object(_.c)((function(e){return e.codingjob})),i=Object(_.b)(),s=Object(r.useState)(c),u=Object(x.a)(s,2),d=u[0],j=u[1];if(Object(r.useEffect)((function(){i(N(d))}),[d,i]),Object(r.useEffect)((function(){c?Ce(c,i):(j(null),i(z([])))}),[c,i]),Object(r.useEffect)((function(){0===o.length&&ye(i,j)}),[o,i]),"table"===a){return Object(E.jsxs)(te.a,{style:{border:"0"},children:[Object(E.jsxs)(w.a.Group,{widths:"2",children:[Object(E.jsx)(ke,{}),Object(E.jsx)(we,{})]}),Object(E.jsx)(X.a,{style:{marginTop:"30px",overflow:"auto",width:"800px"},children:Object(E.jsx)(ve,{columns:[{Header:"Coding job",accessor:"name",headerClass:"thirteen wide"}],data:o||[],selectedRow:d,setSelectedRow:j,defaultSize:15})})]})}if("dropdown"===a){return Object(E.jsx)(se.a,{inline:!0,search:!0,options:(t=o,t.map((function(e){return{key:e.job_id,text:e.name,value:e.name}}))),value:c?c.name:null,onChange:function(e,t){return function(e){if(e&&o.length>0){var t=o.findIndex((function(t){return t.name===e}));j(Object(l.a)(Object(l.a)({},o[t]),{},{ROW_ID:t.toString()}))}else j(null);console.log(d)}(t.value)}})}return null},Ee=[{Header:"doc",accessor:"doc",headerClass:"one wide"},{Header:"title",accessor:"title",headerClass:"six wide"},{Header:"annotations",accessor:"annotations",headerClass:"four wide"}],Te=function(e){var t=e.width,n=Object(_.c)((function(e){return e.codingjob})),a=Object(_.c)((function(e){return e.document})),o=Object(_.c)((function(e){return e.documents})),c=Object(_.b)(),i=Object(r.useState)(a),s=Object(x.a)(i,2),u=s[0],l=s[1];return Object(r.useEffect)((function(){c(function(e){return{type:"SELECT_ARTICLE",payload:e}}(u))}),[u,c]),n?Object(E.jsx)(ve,{columns:Ee,data:o,selectedRow:u,setSelectedRow:l,width:t,defaultSize:15}):null},Re=function(){return Object(E.jsx)(X.a,{style:{marginTop:"30px",overflow:"auto"},children:Object(E.jsx)(Te,{width:"800px"})})},_e=n(323),De=n(207),Ne=function(e){e.setActive;var t=Object(_.c)((function(e){return e.codingjob})),n=Object(r.useState)([]),a=Object(x.a)(n,2),o=a[0],c=a[1],i=Object(r.useRef)();return t?Object(E.jsxs)(ee.a,{stackable:!0,style:{marginTop:"4.3em"},children:[Object(E.jsxs)(ee.a.Row,{children:[Object(E.jsxs)(ee.a.Column,{floated:"right",width:4,children:[" ",Object(E.jsx)(De.a,{ref:i,onFileLoad:function(e){return c(e)},addRemoveButton:!0,onRemoveFile:function(){return c([])},children:Object(E.jsx)("span",{children:"Click to upload"})})]}),Object(E.jsx)(ee.a.Column,{floated:"right",width:10,children:Object(E.jsx)(Ae,{data:o,codingjob:t,fileRef:i})})]}),Object(E.jsx)(ee.a.Row,{children:Object(E.jsx)(ee.a.Column,{children:Object(E.jsx)(ze,{data:o})})})]}):null},Ae=function(e){var t=e.data,n=e.codingjob,a=e.fileRef,o=Object(r.useState)([]),c=Object(x.a)(o,2),i=c[0],s=c[1],u=Object(r.useState)(null),l=Object(x.a)(u,2),d=l[0],b=l[1],p=Object(r.useState)(null),h=Object(x.a)(p,2),O=h[0],v=h[1],m=Object(r.useState)(null),k=Object(x.a)(m,2),y=k[0],C=k[1],S=Object(_.b)();Object(r.useEffect)((function(){if(t.length<=1)return b(null),v(null),C(null),void s([]);s(t[0].data.map((function(e){return{key:e,value:e,text:e}}))),b(t[0].data.includes("title")?"title":null),v(t[0].data.includes("text")?"text":null),C(t[0].data.includes("annotations")?"annotations":null)}),[t]);var T=function(e,t,n,r){var a=e[0].data;return e.slice(1).map((function(e){var o=e.data.reduce((function(e,o,c){var i=a[c];return i===t?e.title=o:i===n?e.text=o:i===r?e.annotations=o:e.meta[i]=o,e}),{meta:{},annotations:""});return o.meta=JSON.stringify(o.meta,null,2),o}))},R=function(){var e=Object(f.a)(j.a.mark((function e(){var r,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=T(t,d,O,y),e.next=4,g.createDocuments(n,r);case 4:return e.next=6,g.listDocuments(n);case 6:return o=e.sent,e.next=9,S(z(o));case 9:a.current.removeFile(),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.log(e.t0);case 15:case"end":return e.stop()}}),e,null,[[0,12]])})));return function(){return e.apply(this,arguments)}}();return t.length<=1?null:Object(E.jsx)(E.Fragment,{children:Object(E.jsxs)(ge.a,{children:[Object(E.jsxs)(ge.a.Group,{children:[Object(E.jsx)(ge.a.Field,{control:_e.a,placeholder:"title column",options:i,value:d,onChange:function(e,t){return b(t.value)}}),Object(E.jsx)(ge.a.Field,{control:_e.a,placeholder:"text column",options:i,value:O,onChange:function(e,t){return v(t.value)}})]}),Object(E.jsxs)(ge.a.Group,{children:[Object(E.jsx)(ge.a.Field,{control:_e.a,clearable:!0,placeholder:"annotations (optional)",options:i,value:y,onChange:function(e,t){return C(t.value)}}),Object(E.jsxs)(ge.a.Field,{control:w.a,fluid:!0,onClick:R,disabled:!d||!O,children:[Object(E.jsx)(G.a,{name:"upload"}),"Upload"]})]})]})})},ze=function(e){var t=e.data,n=function(e){return e.map((function(e){return Object(E.jsx)(fe.a.Cell,{children:Object(E.jsx)("span",{title:e,children:e})})}))};return t.length<=1?null:Object(E.jsxs)(X.a,{style:{marginTop:"2em"},children:[Object(E.jsxs)(fe.a,{fixed:!0,singleLine:!0,basic:"very",children:[Object(E.jsx)(fe.a.Header,{children:Object(E.jsx)(fe.a.Row,{children:function(e){return e[0].data.map((function(e){return Object(E.jsx)(fe.a.HeaderCell,{children:Object(E.jsx)("span",{title:e,children:e})})}))}(t)})}),Object(E.jsx)(fe.a.Body,{children:function(e,t){return e.slice(0,t+1).slice(1).map((function(e){return Object(E.jsx)(fe.a.Row,{children:n(e.data)})}))}(t,5)})]}),t.length>5?Object(E.jsxs)(k.a,{align:"center",children:[t.length-1-5," more rows"]}):null]})},Ie=n(214),Le=(n(303),function(e){var t=e.fields,n=e.fieldValues,r=e.setFieldValues,a=function(e,t){var a=Object(l.a)({},n);a[e]=t,r(a)};return t?Object.keys(t).map((function(e){return"text"===t[e]?Object(E.jsx)(ge.a.TextArea,{value:n[e]?n[e]:"",onChange:function(t,n){return a(e,n.value)},label:e},e):"date"===t[e]?Object(E.jsx)(ge.a.Field,{children:Object(E.jsx)(Ie.a,{label:e,value:n[e]?n[e]:"",onChange:function(t,n){return a(e,n.value)}},e)}):"keyword"===t[e]?Object(E.jsxs)(ge.a.Field,{children:[Object(E.jsx)("label",{children:e}),Object(E.jsx)("input",{value:n[e]?n[e]:"",onChange:function(t){return a(e,t.target.value)}})]},e):null})):null}),Be=function(){var e=Object(_.c)((function(e){return e.codingjob})),t=Object(_.b)(),n=Object(r.useState)({}),a=Object(x.a)(n,2),o=a[0],c=a[1],i=function(){var n=Object(f.a)(j.a.mark((function n(){var r,a,i,s,u;return j.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:for(r=Object(l.a)({},o),a=0,i=Object.keys(r);a<i.length;a++)("date"===(s=i[a])||/_date$/.test(s))&&(r[s]=r[s].toISOString());return n.prev=2,n.next=5,g.createDocuments(e,[r]);case 5:return n.next=7,g.listDocuments(e);case 7:return u=n.sent,n.next=10,t(z(u));case 10:c({}),n.next=16;break;case 13:n.prev=13,n.t0=n.catch(2),console.log(n.t0);case 16:case"end":return n.stop()}}),n,null,[[2,13]])})));return function(){return n.apply(this,arguments)}}();return e?Object(E.jsxs)(ge.a,{style:{marginTop:"3em"},children:[Object(E.jsx)(Le,{fields:{title:"text",text:"text",annotations:"text"},fieldValues:o,setFieldValues:c}),e?Object(E.jsx)(w.a,{primary:!0,onClick:i,children:"Create document"}):null]}):null},Fe=n(331),Pe=function(e){return console.log(e),e.map((function(e){return Object(E.jsx)(Fe.a.Item,{children:e.code})}))},Ge=function(){var e=Object(_.c)((function(e){return e.codingjob})),t=Object(r.useState)([]),n=Object(x.a)(t,2),a=n[0],o=n[1];return Object(r.useEffect)((function(){if(!e)return null;if(!e.codebook)return null;var t=JSON.parse(e.codebook);console.log(t),t&&o(t)}),[e]),e?Object(E.jsx)(ee.a,{stackable:!0,style:{marginTop:"1.0em"},children:Object(E.jsxs)(ee.a.Column,{width:6,children:[Object(E.jsx)(k.a,{as:"h4",children:"Code"}),Object(E.jsx)(Fe.a,{children:Pe(a)})]})}):null},We=function(){var e=Object(r.useState)("details"),t=Object(x.a)(e,2),n=t[0],a=t[1];return Object(E.jsxs)(ee.a,{stackable:!0,style:{marginTop:"3em"},children:[Object(E.jsx)(ee.a.Column,{floated:"left",width:5,children:Object(E.jsx)(Se,{type:"table"})}),Object(E.jsx)(ee.a.Column,{width:11,children:Object(E.jsxs)(te.a,{style:{border:0},children:[Object(E.jsxs)(u.a,{pointing:!0,secondary:!0,children:[Object(E.jsx)(u.a.Item,{name:"details",active:"details"===n,onClick:function(e,t){return a(t.name)}}),Object(E.jsx)(u.a.Item,{name:"codebook",active:"codebook"===n,onClick:function(e,t){return a(t.name)}}),Object(E.jsx)(se.a,{as:u.a.Item,active:n.includes("upload"),text:"Upload Documents",children:Object(E.jsxs)(se.a.Menu,{children:[Object(E.jsx)(se.a.Item,{text:"CSV",onClick:function(e,t){return a("upload CSV")}}),Object(E.jsx)(se.a.Item,{text:"Raw",onClick:function(e,t){return a("upload Raw")}})]})})]}),function(e){switch(e){case"details":return Object(E.jsx)(Re,{});case"codebook":return Object(E.jsx)(Ge,{});case"upload CSV":return Object(E.jsx)(Ne,{});case"upload Raw":return Object(E.jsx)(Be,{});default:return null}}(n)]})})]})},Je=n(340),Ke=n(171),Me=["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"],Ue=function(e,t,n){var r=Object(x.a)(t,2),a=r[0],o=r[1];if(a>o){var c=[o,a];a=c[0],o=c[1]}for(var i=[],s=a;s<=o;s++)i.push({index:s,group:"Not yet assigned",offset:e[a].offset.start,length:e[o].offset.length+e[o].offset.start-e[a].offset.start,span:[a,o]});n(F(i)),n({type:"CLEAR_TOKEN_SELECTION"}),n(B(null,null)),n(B("new_selection",o))},He=function(e,t,n,r,a){var o=n.position;return"ArrowRight"===t&&o++,"ArrowLeft"===t&&o--,"ArrowUp"===t&&(o=Ve(e,n,"up")),"ArrowDown"===t&&(o=Ve(e,n,"down")),o>n.ntokens&&(o=n.ntokens),o<0&&(o=0),n.position!==o&&(a(I(o)),a(L(o,r))),e[o].ref.current.scrollIntoView({block:"center"}),o},Ve=function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"up",a=e[t.position].ref.current.getBoundingClientRect(),o=e[t.startposition].ref.current.getBoundingClientRect();if("up"===r){for(var c=t.position;c>=0;c--)if((n=e[c].ref.current.getBoundingClientRect()).y<a.y&&n.x<o.x)return c;return 0}if("down"===r){for(var i=t.position;i<e.length;i++)if((n=e[i].ref.current.getBoundingClientRect()).y>a.y&&n.x>o.x)return i;return e.length-1}},qe=function(e,t){var n=parseInt(t.getAttribute("tokenindex"));return{index:n,offset:e[n].offset.start,length:e[n].offset.length}},Ye=function(e,t){try{return"token"===t.className||"token selected"===t.className?qe(e,t):!t.parentNode||"token"!==t.parentNode.className&&"token selected"!==t.parentNode.className?null:qe(e,t.parentNode)}catch(t){return console.log(t),null}},Ze=function(e){var t=e.doc,n=e.tokens,a=Object(_.c)((function(e){return e.currentToken})),o=Object(_.c)((function(e){return e.tokenSelection})),c=Object(_.c)((function(e){return e.eventsBlocked})),i=Object(r.useState)(!1),s=Object(x.a)(i,2),u=s[0],l=s[1],d=Object(r.useState)(null),j=Object(x.a)(d,2),f=j[0],b=j[1],p=Object(r.useState)(!1),h=Object(x.a)(p,2),O=h[0],v=h[1],g=Object(r.useState)(null),m=Object(x.a)(g,2),k=m[0],w=m[1],y=Object(_.b)();Object(r.useEffect)((function(){y({type:"CLEAR_SPAN_ANNOTATIONS"})}),[t,y]),Object(r.useEffect)((function(){return window.addEventListener("mousedown",T),window.addEventListener("mousemove",R),window.addEventListener("mouseup",D),window.addEventListener("contextmenu",N),function(){window.removeEventListener("mousedown",T),window.removeEventListener("mousemove",R),window.removeEventListener("mouseup",D),window.removeEventListener("contextmenu",N)}}));var C=Object(r.useCallback)((function(e){"Control"!==e.key&&"Shift"!==e.key?Me.includes(e.key)&&(w(!1),b(null)):v(!1)}),[]),S=Object(r.useCallback)((function(e){if("Control"!==e.key&&"Shift"!==e.key){if(Me.includes(e.key)){if(e.preventDefault(),e.repeat)return;b({position:a,startposition:a,ntokens:n.length,counter:1}),w(e.key)}if(o.length>0)(32===e.keyCode||13===e.keyCode)&&(e.preventDefault(),Ue(n,o,y))}else{if(e.repeat)return;v(!0)}}),[a,o,n,y]);Object(r.useEffect)((function(){return c?(window.removeEventListener("keydown",S),window.removeEventListener("keyup",C),v(!1),w(!1)):(window.addEventListener("keydown",S),window.addEventListener("keyup",C)),function(){window.removeEventListener("keydown",S),window.removeEventListener("keyup",C)}}),[c,S,C]),Object(r.useEffect)((function(){if(f&&k){var e=He(n,k,f,O,y),t=Math.max(5,100/Math.ceil(f.counter/5));1===f.counter&&(t=150),setTimeout((function(){b({position:e,startposition:f.startposition,ntokens:f.ntokens,counter:f.counter+1})}),t)}}),[n,f,k,O,y]);var T=function(e){if(1!==e.which)return null;e.preventDefault(),l(!0),y({type:"CLEAR_TOKEN_SELECTION"})},R=function(e){if(1!==e.which)return null;u&&A(e)},D=function(e){if(1!==e.which)return null;var t=A(e);window.getSelection().empty(),l(!1),o.length>0?Ue(n,o,y):null!==t&&Ue(n,[t,t],y)},N=function(e){if(2===e.button)return null;e.preventDefault(),e.stopPropagation()},A=function(e){var t=Ye(n,e.originalTarget);return t?(y(I(t.index)),y(L(t.index,!0)),t.index):null};return t?Object(E.jsx)(E.Fragment,{}):null},$e=n(148),Qe=function(){var e=Object(f.a)(j.a.mark((function e(t,n){var r,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Set,a=Object.values(n).reduce((function(e,t){for(var n=0,a=Object.keys(t);n<a.length;n++){var o=a[n],c={code:o,offset:t[o].offset,length:t[o].length},i=JSON.stringify(c);r.has(i)||(r.add(i),e.push(c))}return e}),[]),e.next=4,g.writeAnnotations({doc_id:t.doc_id},a);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Xe=function(e,t,n){var r,a={},o=[],c=Object($e.a)(e);try{for(c.s();!(r=c.n()).done;){var i=r.value;et(i,t,a,o)}}catch(j){c.e(j)}finally{c.f()}for(var s={},u=0,l=o;u<l.length;u++){var d=l[u];s[d.group]||(s[d.group]=0),s[d.group]++,tt(d,n)}console.log(s)},et=function(e,t,n,r){for(var a=e.offset.start,o=e.offset.start+e.offset.length,c=a;c<=o;c++)if(t[c]){var i,s=Object($e.a)(t[c].start);try{for(s.s();!(i=s.n()).done;){var u=i.value;n[u]={index:e.offset.index,group:u,offset:a,length:null,span:[e.offset.index]}}}catch(f){s.e(f)}finally{s.f()}var l,d=Object($e.a)(t[c].end);try{for(d.s();!(l=d.n()).done;){var j=l.value;n[j].span.push(e.offset.index),n[j].length=e.offset.start+e.offset.length-n[j].offset,r.push(n[j]),delete n[j]}}catch(f){d.e(f)}finally{d.f()}}},tt=function(e,t){for(var n=[],r=e.span[0];r<=e.span[1];r++){var a=Object(l.a)({},e);a.index=r,n.push(a)}t(F(n))},nt=function(e){var t=e.doc,n=e.tokens,a=Object(_.c)((function(e){return e.spanAnnotations})),o=Object(r.useState)(!1),c=Object(x.a)(o,2),i=c[0],s=c[1],u=Object(_.b)();return Object(r.useEffect)((function(){s(!1)}),[t]),Object(r.useEffect)((function(){n.length>0&&t.annotations&&!i&&(Xe(n,t.annotations,u),s(!0))}),[i,n,t,u]),Object(r.useEffect)((function(){i&&Qe(t,a)}),[i,t,a]),Object(E.jsx)("div",{})},rt=(n(304),n(332)),at=n(327),ot=["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"],ct=a.a.memo((function(e){var t=e.index,n=e.children,a=e.annotations,o=e.csTrigger,c=Object(_.c)((function(e){return e.codes})),i=Object(_.c)((function(e){return e.codeHistory})),s=Object(r.useRef)(null),u=Object(r.useState)(null),l=Object(x.a)(u,2),d=l[0],j=l[1],f=Object(r.useState)(!1),b=Object(x.a)(f,2),p=b[0],h=b[1],O=Object(r.useState)(0),v=Object(x.a)(O,2),g=v[0],m=v[1],k=Object(_.b)();Object(r.useEffect)((function(){if(a)return d?null:void(a&&void 0!==a&&(Object.keys(a).includes("Not yet assigned")?j("Not yet assigned"):j(Object.keys(a)[0])))}),[d,j,t,a]),Object(r.useEffect)((function(){return window.addEventListener("keydown",y),k(D(!0)),function(){window.removeEventListener("keydown",y),k(D(!1))}}),[k]);var y=function(e){ot.includes(e.key)||s.current&&s.current.click()};return Object(E.jsx)(at.a,{trigger:n,flowing:!0,hoverable:!0,wide:!0,open:!0,mouseLeaveDelay:1e3,onOpen:function(){return h(!0)},onClose:function(){p&&o&&setTimeout((function(){return k(B(null))}),10)},position:"top left",children:function(e){var t=Object.keys(a),n=0===e&&t.length>1&&"new_selection"!==o;return console.log(e),n?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("h5",{children:"Current Code:"}),Object(E.jsx)(w.a.Group,{compact:!0,children:t.map((function(e){return Object(E.jsx)(w.a,{style:{backgroundColor:ut(e,c)},onClick:function(){m(1),j(e)},children:e})}))})]}):Object(E.jsxs)(E.Fragment,{children:[Object(E.jsx)("h5",{children:"New code:"}),Object(E.jsxs)(w.a.Group,{compact:!0,children:[it(a,i,d,c,j,k),Object(E.jsx)(w.a,{icon:"delete",size:"mini",color:"red",onClick:function(e,t){return st(a,d,d,j,k)}})]}),"\xa0\xa0",Object(E.jsx)(rt.a,{innerRef:s,children:Object(E.jsx)(se.a,{placeholder:"Search",options:c.map((function(e){return{key:e.code,value:e.code,text:e.code}})),search:!0,selection:!0,selectOnNavigation:!1,minCharacters:0,autoComplete:"on",searchInput:{autoFocus:!1},onChange:function(e,t){return st(a,d,t.value,j,k)}})})]})}(g)})})),it=function(e,t,n,r,a,o){return t.filter((function(e){return e!==n&&"Not yet assigned"!==e})).map((function(t){return Object(E.jsx)(w.a,{style:{backgroundColor:ut(t,r)},value:t,onClick:function(t,r){return st(e,n,r.value,a,o)},children:t},t)}))},st=function(e,t,n,r,a){var o=t,c=e;if(!c)return null;var i={index:c[o].index,group:o,offset:c[o].offset,length:c[o].length,span:c[o].span},s=Object(l.a)({},i);if(s.span=[s.index,s.index],a({type:"RM_ANNOTATIONS",payload:[s]}),n===o)return a(B(null,null)),null;for(var u=[],d=i.span[0];d<=i.span[1];d++){var j=Object(l.a)({},i);j.group=n,j.index=d,u.push(j)}a(F(u)),a(function(e){return{type:"APPEND_CODE_HISTORY",payload:{code:e,n:arguments.length>1&&void 0!==arguments[1]?arguments[1]:5}}}(n)),Object.keys(c).includes(null)?r(null):r(n),a(B(null,null))},ut=function(e,t){var n=t.find((function(t){return t.code===e}));return n?n.color:"lightgrey"},lt=ct,dt=a.a.forwardRef((function(e,t){var n=e.token,r=Object(_.c)((function(e){if(0===e.tokenSelection.length)return!1;var t=Object(x.a)(e.tokenSelection,2),r=t[0],a=t[1];if(r>a){var o=[r,a];a=o[0],r=o[1]}return n.offset.index>=r&&n.offset.index<=a})),a="token";return r&&(a+=" selected"),Object(E.jsx)("span",{ref:t,className:a,tokenindex:n.offset.index,children:Object(E.jsx)(jt,{token:n,selected:r})})})),jt=function(e){var t=e.token,n=e.selected,r=Object(_.c)((function(e){return e.spanAnnotations[t.offset.index]})),a=Object(_.c)((function(e){return e.codeSelectorTrigger.index!==t.offset.index?null:e.codeSelectorTrigger.from})),o=Object(_.c)((function(e){return e.codes})),c=Object(_.b)();if(Object(_.c)((function(e){return JSON.stringify(e.spanAnnotations[t.offset.index])})),!r)return Object(E.jsx)(E.Fragment,{children:t.pre+t.text+t.post});var i=function(e,t){var n=t.find((function(t){return t.code===e}));return n?n.color:"lightgrey"},s=function(e,n){return Object(E.jsxs)("span",{className:e,onContextMenu:function(e){e.preventDefault(),c(B("right_click",t.offset.index))},style:n?{background:n}:null,children:[j&&f?t.text:null,j&&!f?t.text+t.post:null,f&&!j?t.pre+t.text:null,j||f?null:t.pre+t.text+t.post]})},u=Object.keys(r),l=null;if(1===u.length)l=i(u[0],o);else{var d=u.map((function(e){return i(e,o)}));l="linear-gradient(".concat(d.join(", "),")")}var j=!Object.values(r).some((function(e){return e.span[0]!==e.index})),f=!Object.values(r).some((function(e){return e.span[1]!==e.index})),b=Object.values(r).some((function(e){return e.span[0]===e.index})),p=Object.values(r).some((function(e){return e.span[1]===e.index})),h="annotatedToken";return j&&(h+=" allLeft"),b&!j&&(h+=" anyLeft"),f&&(h+=" allRight"),p&!f&&(h+=" anyRight"),n&&(l=null,h+=" selected"),Object(E.jsxs)(E.Fragment,{children:[j?t.pre:null,a?Object(E.jsx)(lt,{index:t.offset.index,annotations:r,csTrigger:a,children:s(h,l)}):s(h,l),f?t.post:null]})},ft=a.a.memo(dt),bt=n(170),pt=n(211);bt.a.extend(pt.a);var ht=function(e){var t=e.text,n=e.setTokens,a=Object(r.useState)(null),o=Object(x.a)(a,2),c=o[0],i=o[1];return Object(r.useEffect)((function(){var e=Ot(t),r=Object(x.a)(e,2),a=r[0],o=r[1];i(a),n(o)}),[t,n]),null===t?null:Object(E.jsx)(X.a,{text:!0,children:Object(E.jsx)(te.a,{style:{border:"0"},children:c})})},Ot=function(e){var t=[];return[bt.a.tokenize(e).paragraphs().json({offset:!0}).map((function(e,n){return vt(e,n,t)})),t]},vt=function(e,t,n){var r=function(e){return e.sentences.map((function(e){return e.map((function(e){return gt(e,n)}))}))};return Object(E.jsx)("span",{style:{marginTop:"1em",display:"table"},children:0===t?Object(E.jsx)("h2",{children:r(e)}):r(e)},t)},gt=function(e,t){return Object(E.jsx)("span",{className:"sentence",children:function(e){return e.terms.map((function(e){return e.ref=a.a.createRef(),t.push(e),Object(E.jsx)(ft,{ref:e.ref,token:e},e.offset.index)}))}(e)},e.offset.index)},xt=a.a.memo(ht),mt=function(e){var t=e.doc,n=Object(r.useState)([]),a=Object(x.a)(n,2),o=a[0],c=a[1];return t?Object(E.jsxs)(E.Fragment,{children:[Object(E.jsxs)(ee.a.Row,{children:[Object(E.jsx)(ee.a.Column,{width:10,children:Object(E.jsx)(xt,{text:t.text,setTokens:c})}),Object(E.jsx)(ee.a.Column,{width:6})]}),Object(E.jsx)(Ze,{doc:t,tokens:o}),Object(E.jsx)(nt,{doc:t,tokens:o})]}):null},kt=function(){var e=Object(f.a)(j.a.mark((function e(t,n,r){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.listDocuments(t);case 2:if(a=e.sent,console.log(a),r(a),!(a.length>0)){e.next=10;break}return e.next=8,wt(n,a[0].doc_id);case 8:e.next=11;break;case 10:n(null);case 11:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),wt=function(){var e=Object(f.a)(j.a.mark((function e(t,n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g.getDocument(n);case 2:r=e.sent,t({doc_id:r.doc_id,text:r.title+"\n\n"+r.text,annotations:yt(r.annotations)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),yt=function(e){return e&&""!==e?JSON.parse(e).reduce((function(e,t){return e[t.offset]||(e[t.offset]={start:[],end:[]}),e[t.offset+t.length]||(e[t.offset+t.length]={start:[],end:[]}),e[t.offset].start.push(t.code),e[t.offset+t.length].end.push(t.code),e}),{}):{}},Ct=function(e){return e.map((function(e,t){return{key:t,text:e.title,value:e.doc_id}}))},St="/amcat4annotator",Et=[{label:"Coding Jobs",path:St+"/codingjobs",Component:We},{label:"Annotate",path:St+"/annotate",Component:function(){var e=Object(_.c)((function(e){return e.codingjob})),t=Object(_.b)(),n=Object(r.useState)(null),a=Object(x.a)(n,2),o=a[0],c=a[1],i=Object(r.useState)([]),s=Object(x.a)(i,2),u=s[0],l=s[1];Object(r.useEffect)((function(){if(!e)return null;if(kt(e,c,l),e.codebook){var n=JSON.parse(e.codebook);n&&n.length>0?t(P(n)):t(P([]))}}),[e,t]);return Object(E.jsx)(E.Fragment,{children:Object(E.jsxs)(ee.a,{children:[Object(E.jsx)(ee.a.Row,{children:Object(E.jsxs)(Je.a,{children:[Object(E.jsx)(Ke.a,{link:!0,children:Object(E.jsx)(Se,{type:"dropdown"})}),Object(E.jsx)(Je.a.Divider,{}),Object(E.jsx)(Ke.a,{link:!0,children:function(e,t){var n=Ct(t);return Object(E.jsx)(se.a,{inline:!0,search:!0,onChange:function(t,n){wt(e,n.value)},options:n,value:o?o.doc_id:null})}(c,u)})]})}),Object(E.jsx)(mt,{doc:o||null})]})})}}],Tt=function(){var e;return Object(E.jsxs)(i.a,{children:[Object(E.jsx)($,{items:Et,homepage:St}),Object(E.jsx)(Q.a,{}),Object(E.jsx)(X.a,{style:{marginTop:"3em"},children:Object(E.jsxs)(s.d,{children:[Object(E.jsx)(s.b,{exact:!0,path:St,render:function(){return Object(E.jsx)(oe,{items:Et})}}),(e=Et,e.map((function(e){return Object(E.jsx)(ie,{path:e.path,homepage:St,Component:e.Component},e.path)})))]})})]})},Rt=n(89),_t=n(212),Dt=function(e,t,n){return n&&0!==e.length?[e[0],t]:[t,t]},Nt=function(e,t,n){for(var r in t){var a=t[r];if(e[a.index]&&e[a.index][a.group]){for(var o=e[a.index][a.group].span,c=o[0];c<=o[1];c++)e[c]&&e[c][a.group]&&(delete e[c][a.group],0===Object.keys(e[c]).length&&delete e[c]);if(a.span[0]===a.span[1])continue}n||(e[a.index]||(e[a.index]={}),e[a.index][a.group]={index:a.index,span:[a.span[0],a.span[1]],offset:a.offset,length:a.length})}return e},At=Object(Rt.b)({db:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DB":return t.payload;case"RESET_DB":return null;default:return e}},eventsBlocked:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"BLOCK_EVENTS":return t.payload;default:return e}},codingjob:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_CODINGJOB":return t.payload;case"RESET_DB":return null;default:return e}},codingjobs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CODINGJOBS":return t.payload;case"RESET_DB":return[];default:return e}},document:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_DOCUMENT":return t.payload;case"RESET_DB":return[];default:return e}},documents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DOCUMENTS":return t.payload;case"RESET_DB":return[];default:return e}},tokenIndices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN_INDICES":return t.payload;case"SELECT_DOCUMENT":case"RESET_DB":return[];default:return e}},currentToken:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_TOKEN":return t.payload;case"SELECT_DOCUMENT":case"RESET_DB":return 0;default:return e}},codeSelectorTrigger:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:null,index:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TRIGGER_CODESELECTOR":return{from:t.from,index:t.index};default:return e}},tokenSelection:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN_SELECTION":return Dt(e,t.index,t.add);case"CLEAR_TOKEN_SELECTION":case"RESET_DB":return[];default:return e}},spanAnnotations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_ANNOTATIONS":return Nt(Object(l.a)({},e),t.payload,!1);case"RM_ANNOTATIONS":return Nt(Object(l.a)({},e),t.payload,!0);case"CLEAR_SPAN_ANNOTATIONS":case"RESET_DB":return{};default:return e}},codes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CODES":return t.payload.map((function(e){return e.color||(e.color=Object(_t.randomColor)({seed:e.code,luminosity:"bright"})),e}));case"RESET_DB":return[];default:return e}},codeHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APPEND_CODE_HISTORY":var n=e.filter((function(e){return e!==t.payload.code})).slice(0,t.payload.n-1);return n.unshift(t.payload.code),n;case"RESET_DB":return[];default:return e}}}),zt=Object(Rt.c)(At);c.a.render(Object(E.jsx)(a.a.StrictMode,{children:Object(E.jsx)(_.a,{store:zt,children:Object(E.jsx)(Tt,{})})}),document.querySelector("#root"))}},[[306,1,2]]]);
//# sourceMappingURL=main.2d3c9cb6.chunk.js.map