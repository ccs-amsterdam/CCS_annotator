(this.webpackJsonpamcat4annotator=this.webpackJsonpamcat4annotator||[]).push([[0],{333:function(e,t){},335:function(e,t){},344:function(e,t){},346:function(e,t){},372:function(e,t){},373:function(e,t){},378:function(e,t){},380:function(e,t){},387:function(e,t){},406:function(e,t){},464:function(e,t,n){var r={"./bg-BG.json":465,"./ca-ES.json":466,"./cs-CZ.json":467,"./de-DE.json":468,"./en-US.json":290,"./es-ES.json":469,"./et-EE.json":470,"./fi-FI.json":471,"./fr-FR.json":472,"./he-IL.json":473,"./it-IT.json":474,"./ja-JP.json":475,"./ko-KR.json":476,"./nb-NO.json":477,"./nn-NO.json":478,"./pl-PL.json":479,"./pt-BR.json":480,"./ru-RU.json":481,"./sv-SE.json":482,"./tr-TR.json":483,"./zh-CN.json":484};function o(e){var t=c(e);return n(t)}function c(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=c,e.exports=o,o.id=464},486:function(e,t,n){},487:function(e,t,n){"use strict";n.r(t);n(320);var r,o=n(0),c=n.n(o),a=n(59),i=n.n(a),s=n(83),u=n(18),l=n(8),d=n(519),j=n(13),b=n.n(j),f=n(17),p=n(12),h=function(e){return{type:"SET_DB",payload:e}},O=function(e){return{type:"SET_DROPBOX",payload:e}},x=function(e){return{type:"SELECT_CODINGJOB",payload:e}},v=function(e){return{type:"SET_CODINGJOBS",payload:e}},g=function(e){return{type:"TOGGLE_ANNOTATIONS",payload:e}},m=n(513),y=n(515),w=n(488),k=n(144),C=n(145),S=n(209),E=n(295),T=n.n(E),_=function(){function e(t,n){Object(k.a)(this,e),this.dbx=t,this.user=n}return Object(C.a)(e,[{key:"readJSON",value:function(e){this.dbx.filesDownload({path:"/".concat(this.user.email,"/").concat(e)})}},{key:"writeJSON",value:function(e,t){var n=new File(e,t,{type:"application/json"});this.dbx.filesUpload({path:"/".concat(this.user.email,"/").concat(n.name),contents:n})}}]),e}(),A=function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setAccessToken(n),r=new S.Dropbox({auth:t}),e.next=4,r.usersGetCurrentAccount();case 4:return o=e.sent,e.abrupt("return",new _(r,o.result));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),D=function(){var e=Object(f.a)(b.a.mark((function e(t,n,r){var o,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=window.sessionStorage.getItem("codeVerifier"),t.setCodeVerifier(o),e.next=4,t.generateCodeChallenge();case 4:return e.next=6,t.getAccessTokenFromCode(r,n);case 6:return c=e.sent,e.abrupt("return",{token:c.result.access_token,refresh_token:c.result.refresh_token,expiration_date:Date.now()+1e3*c.result.expires_in});case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),N=n(1),R=function(){var e=Object(o.useState)(!1),t=Object(p.a)(e,2),n=t[0],r=t[1],c=Object(l.c)((function(e){return e.dropbox})),a=Object(l.b)(),i=Object(l.c)((function(e){return e.db}));return Object(N.jsxs)(m.a,{closeIcon:!0,open:n,trigger:Object(N.jsx)(d.a.Item,{icon:"dropbox",name:"Sync",style:{color:"lightblue"}}),onClose:function(){return r(!1)},onOpen:function(){return r(!0)},children:[Object(N.jsx)(y.a,{icon:"dropbox",content:"Synchronize with Dropbox"}),Object(N.jsx)(m.a.Content,{children:Object(N.jsx)("p",{children:"Something about synchronization."})}),Object(N.jsxs)(m.a.Actions,{children:[Object(N.jsx)(w.a,{primary:!0,onClick:function(){c.writeJSON(["test"],"test.json")},children:"Synchronize"}),Object(N.jsx)(w.a,{primary:!0,onClick:function(){i&&i.deleteToken("dropbox"),a(O(null))},children:"Disconnect"})]})]})},I="/create",F="http://localhost:3000"+I,B=(r="doge8b5gywmaz6x",new S.DropboxAuth({clientId:r})),P=function(){var e=Object(o.useState)(),t=Object(p.a)(e,2),n=t[0],r=t[1],c=Object(l.c)((function(e){return e.dropbox})),a=Object(l.c)((function(e){return e.db})),i=Object(o.useState)(!0),s=Object(p.a)(i,2),j=s[0],h=s[1],x=Object(l.b)(),v=Object(u.g)();Object(o.useEffect)((function(){if(console.log("listen"),!c&&a){var e=function(){var e=Object(f.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A(B,t.token);case 3:return n=e.sent,e.next=6,a.addToken("dropbox",t);case 6:return e.next=8,x(O(n));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();j&&(h(!1),a.getToken("dropbox").then((function(t){t&&t.token&&(Date.now()>t.expiration_date?(console.log("Trying refresh"),B.setRefreshToken(t.refresh_token),B.refreshAccessToken().then(e)):e(t))})));var t=T.a.parse(window.location.search).code;t&&D(B,t,F).then(e).then((function(){v.push(I)})).catch((function(e){return console.log(e)}))}}),[c,a,j,x,v]);return a?c?Object(N.jsx)(R,{}):Object(N.jsxs)(m.a,{closeIcon:!0,open:n,trigger:Object(N.jsx)(d.a.Item,{icon:"dropbox",name:"Connect"}),onClose:function(){return r(!1)},onOpen:function(){return r(!0)},children:[Object(N.jsx)(y.a,{icon:"dropbox",content:"Connect to Dropbox"}),Object(N.jsxs)(m.a.Content,{children:[Object(N.jsx)("p",{children:"This app connects with Dropbox using OAuth 2.0 authorization with PKCE flow. Your will exchange your data directly with Dropbox, so we can't touch it. (So we also can't help you if you lose it)"}),Object(N.jsx)("p",{children:"As Dropbox will also tell you, this app will only have read/write access to the Apps/AmCAT_Annotator folder in your dropbox. So even if you don't trust us we're quite harmless."})]}),Object(N.jsx)(m.a.Actions,{children:Object(N.jsx)(w.a,{primary:!0,onClick:function(){var e,t;t=F,(e=B).getAuthenticationUrl(t,void 0,"code","offline",void 0,void 0,!0).then((function(t){window.sessionStorage.clear(),window.sessionStorage.setItem("codeVerifier",e.codeVerifier),window.location.href=t})).catch((function(e){return console.error(e)}))},children:"Authenticate"})})]}):null},G=n(297),L=n(298),J=n.n(L);function z(e){var t=e.totalRows,n=e.completedRows;console.log("Progress: ".concat(n," of ").concat(t," rows completed"))}var H=function(){var e=Object(o.useState)(!1),t=Object(p.a)(e,2),n=t[0],r=t[1],c=Object(l.c)((function(e){return e.db})),a=function(){var e=Object(f.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(c),e.next=4,Object(G.a)(c.idb,{filter:function(e,t,n){return"codingjobs"===e||"documents"===e},prettyJson:!0,progressCallback:z});case 4:t=e.sent,J()(t,"AmCAT_Annotator.json"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(""+e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(N.jsxs)(m.a,{closeIcon:!0,open:n,trigger:Object(N.jsx)(d.a.Item,{icon:"download",name:"Download",style:{color:"lightgreen"}}),onClose:function(){return r(!1)},onOpen:function(){return r(!0)},children:[Object(N.jsx)(y.a,{icon:"dropbox",content:"Download everything"}),Object(N.jsx)(m.a.Content,{children:Object(N.jsx)("p",{children:"Download all data as a single JSON dump"})}),Object(N.jsx)(m.a.Actions,{children:Object(N.jsx)(w.a,{primary:!0,onClick:a,children:"Download"})})]})},M=n(78),U=function(){var e=Object(l.c)((function(e){return e.db})),t=Object(l.b)(),n=Object(o.useState)(!1),r=Object(p.a)(n,2),c=r[0],a=r[1],i=Object(u.g)();return e?Object(N.jsxs)(m.a,{closeIcon:!0,open:c,trigger:Object(N.jsx)(d.a.Item,{icon:"rocket",name:"Reset",style:{color:"#d7a3a3"}}),onClose:function(){return a(!1)},onOpen:function(){return a(!0)},children:[Object(N.jsx)(y.a,{icon:"power off",content:"Reset Annotator Database"}),Object(N.jsx)(m.a.Content,{children:Object(N.jsx)("p",{children:"This will remove all document and annotation data from your browser. Any annotations that have not been saved/synchronized will be lost. Are you absolutely sure?"})}),Object(N.jsxs)(m.a.Actions,{children:[Object(N.jsxs)(w.a,{color:"red",onClick:function(){a(!1)},children:[Object(N.jsx)(M.a,{name:"remove"})," No"]}),Object(N.jsxs)(w.a,{color:"green",onClick:function(){console.log(e),e.deleteDB().then((function(){t({type:"RESET_DB"}),a(!1),i.push("/")})).catch((function(e){console.log(e)}))},children:[Object(N.jsx)(M.a,{name:"checkmark"})," Yes"]})]})]}):null};function V(){return q.apply(this,arguments)}function q(){return(q=Object(f.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Z();case 2:t=e.sent,e.t0=t,e.next="never"===e.t0?6:"persisted"===e.t0?8:"prompt"===e.t0?10:12;break;case 6:return console.log("Not possible to persist storage"),e.abrupt("break",13);case 8:return console.log("Successfully persisted storage silently"),e.abrupt("break",13);case 10:return console.log("Not persisted, but we may prompt user when we want to."),e.abrupt("break",13);case 12:console.log("compiler desperately wanted a default");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return K.apply(this,arguments)}function K(){return(K=Object(f.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.storage;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=navigator.storage.persist;case 5:if(!e.t0){e.next=9;break}e.t1=navigator.storage.persist(),e.next=10;break;case 9:e.t1=void 0;case 10:return e.abrupt("return",e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return X.apply(this,arguments)}function X(){return(X=Object(f.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.storage;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=navigator.storage.persisted;case 5:if(!e.t0){e.next=9;break}e.t1=navigator.storage.persisted(),e.next=10;break;case 9:e.t1=void 0;case 10:return e.abrupt("return",e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(){return $.apply(this,arguments)}function $(){return($=Object(f.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.storage&&navigator.storage.persisted){e.next=2;break}return e.abrupt("return","never");case 2:return e.next=4,navigator.storage.persisted();case 4:if(!e.sent){e.next=7;break}return e.abrupt("return","persisted");case 7:if(navigator.permissions&&navigator.permissions.query){e.next=9;break}return e.abrupt("return","prompt");case 9:return e.next=11,navigator.permissions.query({name:"persistent-storage"});case 11:if("granted"!==(t=e.sent).state){e.next=21;break}return e.next=15,navigator.storage.persist();case 15:if(!e.sent){e.next=20;break}return e.abrupt("return","persisted");case 20:throw new Error("Failed to persist");case 21:if("prompt"!==t.state){e.next=23;break}return e.abrupt("return","prompt");case 23:return e.abrupt("return","never");case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Q=function(){var e=Object(o.useState)(!1),t=Object(p.a)(e,2),n=t[0],r=t[1],c=Object(o.useState)(!1),a=Object(p.a)(c,2),i=a[0],s=a[1];Object(o.useEffect)((function(){i||W().then(s)}),[i]);var u=function(){var e=Object(f.a)(b.a.mark((function e(){return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y();case 2:return e.next=4,W();case 4:e.sent?(s(!0),alert("indexedDB set to persistent for AmCAT Annotator")):alert("Failed to set indexedDB to persistent");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i?null:Object(N.jsxs)(m.a,{closeIcon:!0,open:n,trigger:Object(N.jsx)(d.a.Item,{icon:"database",name:"Enable persitance",style:{color:"#d7a3a3"}}),onClose:function(){return r(!1)},onOpen:function(){return r(!0)},children:[Object(N.jsx)(y.a,{icon:"database",content:"Set database persistence"}),Object(N.jsxs)(m.a.Content,{children:[Object(N.jsx)("p",{children:"We did not have permission to automatically make the data storage for this website persistent. This means that the data could be removed automatically by your browser if it needs to free up space for another website. You can try to set this manually here, but not all browsers support this (yet)."}),Object(N.jsx)("p",{children:"If the database is not persistent the app can still be used, but you need to be more carefull in making sure that data is regularly backed up, either by manually downloading data or syncing with Dropbox"})]}),Object(N.jsx)(m.a.Actions,{children:Object(N.jsxs)(w.a,{onClick:u,children:[Object(N.jsx)(M.a,{name:"checkmark"})," Yes"]})})]})},ee=Object(u.i)((function(e){var t=e.items,n=Object(l.c)((function(e){return e.db})),r=Object(u.h)(),o=t.map((function(e,t){return Object(N.jsx)(d.a.Item,{index:t,as:s.b,to:e.path,header:0===t,disabled:!n,active:e.path===r.pathname,children:e.label},"item-"+t)}));return Object(N.jsxs)(d.a,{fixed:"top",inverted:!0,children:[o,Object(N.jsxs)(d.a.Menu,{position:"right",children:[Object(N.jsx)(P,{}),Object(N.jsx)(H,{}),Object(N.jsx)(Q,{}),Object(N.jsx)(U,{})]})]})})),te=n(509),ne=n(508),re=n(107),oe=n(163),ce=n(16),ae=n(213),ie=n.n(ae),se=function(){function e(){Object(k.a)(this,e),this.idb=new re.a("AmCAT_Annotator"),this.idb.version(1).stores({apis:"api",codingjobs:"job_id, name",documents:"doc_id, job_id"})}return Object(C.a)(e,[{key:"addToken",value:function(e,t){return this.idb.apis.put({api:e,token:t.token,refresh_token:t.refresh_token,expiration_date:t.expiration_date})}},{key:"deleteToken",value:function(e){return this.idb.apis.delete(e)}},{key:"getToken",value:function(e){return this.idb.apis.get(e)}},{key:"createCodingjob",value:function(e){var t=ie()([e,Date.now().toString()]);return this.idb.codingjobs.add({job_id:t,name:e})}},{key:"deleteCodingjob",value:function(){var e=Object(f.a)(b.a.mark((function e(t){var n;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.listDocuments(t);case 2:return n=e.sent,e.next=5,this.deleteDocuments(n);case 5:return e.abrupt("return",this.idb.codingjobs.delete(t.job_id));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listCodingjobs",value:function(){return this.idb.codingjobs.toArray()}},{key:"getCodingjob",value:function(e){return this.idb.codingjobs.get("name").equals(e)}},{key:"createDocuments",value:function(){var e=Object(f.a)(b.a.mark((function e(t,n){var r,o,c,a;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Set,e.next=3,this.idb.documents.where("job_id").equals(t.job_id).primaryKeys();case 3:return e.t1=e.sent,r=new e.t0(e.t1),o=0,c=n.reduce((function(e,n){var c=ie()([n,t]);if(r.has(c))o++;else{if(r.add(c),n.annotations&&n.annotations.length>0){console.log(n.annotations);try{JSON.parse(n.annotations)}catch(a){throw alert("Annotations field contains invalid JSON"),new Error("JSON parse error")}}e.push(Object(ce.a)({doc_id:c,job_id:t.job_id},n))}return e}),[]),a="Created ".concat(n.length-o," new documents in codingjob ").concat(t.name,"."),o>0&&(a+=" Ignored ".concat(o," duplicates")),alert(a),e.abrupt("return",this.idb.documents.bulkAdd(c));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteDocuments",value:function(e){var t=e.map((function(e){return e.doc_id}));return this.idb.documents.bulkDelete(t)}},{key:"listDocuments",value:function(e){return this.idb.documents.where("job_id").equals(e.job_id).toArray()}},{key:"getDocument",value:function(e){return this.idb.documents.get(e)}},{key:"writeValue",value:function(e,t,n){return this.idb.documents.where("doc_id").equals(e.doc_id).modify(Object(oe.a)({},t,n))}},{key:"deleteDB",value:function(){return this.idb.delete()}}]),e}(),ue=n(517),le=n(518),de=n(308),je=function(e){var t=e.items,n=Object(l.b)(),r=Object(u.g)(),o=function(){var e=Object(f.a)(b.a.mark((function e(){var o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,new se;case 3:return o=e.sent,n(h(o)),e.next=7,V();case 7:r.push(t[0].path),e.next=12;break;case 10:e.prev=10,e.t0=e.catch(0);case 12:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();return re.a.exists("AmCAT_Annotator").then((function(e){e&&o()})),Object(N.jsx)(ue.a,{inverted:!0,textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(N.jsx)(ue.a.Column,{style:{maxWidth:450},children:Object(N.jsxs)(le.a,{style:{border:0},children:[Object(N.jsxs)(y.a,{as:"h2",textAlign:"center",children:[Object(N.jsx)(de.a,{src:"/amcat-logo.svg"})," Welcome to the AmCAT annotator"]}),Object(N.jsx)("p",{children:"This is the (early development version of the) AmCAT annotator. The fact that you see this message means that you're either here for the first time, or your local annotation database was reset (by you or your browser)."}),Object(N.jsx)("p",{children:"The annotator stores your codingjobs and annotations on your local computer in your browser's IndexedDB. Your data will only actually touch the internet when you synchronize your data. Currently we've implemented syncronization with Dropbox. This way we have nothing to do with your data."}),Object(N.jsx)(w.a,{primary:!0,onClick:o,children:"Yes, off course I trust you"})]})})})},be=n(307),fe=function(e){var t=e.Component,n=Object(be.a)(e,["Component"]),r=Object(l.b)(),o=function(){var e=Object(f.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new se;case 2:t=e.sent,r(h(t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return re.a.exists("AmCAT_Annotator").then((function(e){if(o(),!e)return Object(N.jsx)(u.a,{to:"/"})})),Object(N.jsx)(u.b,Object(ce.a)(Object(ce.a)({},n),{},{render:function(e){return Object(N.jsx)(t,Object(ce.a)(Object(ce.a)({},n),e))}}))},pe=n(134),he=n(133),Oe=n(299),xe=n(120),ve=n(108),ge=n(522),me=n(129),ye=n(214),we=n(523),ke=function(e){var t=e.columns,n=e.data,r=e.selectedRow,c=e.setSelectedRow,a=e.defaultSize,i=void 0===a?15:a,s=Object(o.useState)(r?r.ROW_ID:null),u=Object(p.a)(s,2),l=u[0],d=u[1],j=Object(he.useTable)({columns:t,data:n,initialState:{pageSize:i,globalFilter:""}},he.useGlobalFilter,he.useSortBy,he.usePagination),b=j.getTableProps,f=j.getTableBodyProps,h=j.headerGroups,O=j.prepareRow,x=j.page,v=j.pageCount,g=j.gotoPage,m=j.setPageSize,y=j.preGlobalFilteredRows,w=j.setGlobalFilter,k=j.state,C=k.pageIndex,S=k.globalFilter;Object(o.useEffect)((function(){d(r?r.ROW_ID:null)}),[r]);var E=function(e){var t=e.preGlobalFilteredRows,n=e.globalFilter,r=e.setGlobalFilter,o=t&&t.length;return Object(N.jsx)("span",{children:Object(N.jsx)("input",{value:n||"",onChange:function(e){r(e.target.value||void 0)},placeholder:"Search ".concat(o," records..."),style:{border:"0"}})})},T=function(e){return e.headers.map((function(e){return Object(N.jsxs)(Oe.a,Object(ce.a)(Object(ce.a)({className:e.headerClass},e.getHeaderProps(e.getSortByToggleProps())),{},{children:[e.render("Header"),Object(N.jsx)("span",{children:e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""})]}))}))};return 0===n.length?null:Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(E,{preGlobalFilteredRows:y,globalFilter:S,setGlobalFilter:w}),Object(N.jsxs)(ge.a,Object(ce.a)(Object(ce.a)({striped:!0,fixed:!0,singleLine:!0,selectable:!0},b()),{},{children:[Object(N.jsx)(me.a,{children:h.map((function(e){return Object(N.jsx)(xe.a,Object(ce.a)(Object(ce.a)({},e.getHeaderGroupProps()),{},{children:T(e)}))}))}),Object(N.jsx)(ye.a,Object(ce.a)(Object(ce.a)({},f()),{},{children:function(e){return e.map((function(e,t){return O(e),Object(N.jsx)(xe.a,Object(ce.a)(Object(ce.a)({active:!!l&&l===e.id,onClick:function(){return function(e){l&&l===e.id?(c(null),d(null)):(c(Object(ce.a)(Object(ce.a)({},n[e.id]),{},{ROW_ID:e.id})),d(e.id))}(e)}},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(N.jsx)(ve.a,Object(ce.a)(Object(ce.a)({title:e.value},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}(x)}))]})),Object(N.jsx)(pe.a,{text:"show per page",options:[10,25,50,100,500].map((function(e){return{value:e,text:e}})),onChange:function(e,t){m(t.value)}}),Object(N.jsx)("div",{style:{marginTop:"3em",display:"flex",justifyContent:"flex-end"},children:Object(N.jsx)(we.a,{style:{border:"0"},size:"mini",firstItem:!1,lastItem:!1,nextItem:!1,prevItem:!1,boundaryRange:1,ellipsisItem:{content:Object(N.jsx)(M.a,{name:"ellipsis horizontal"}),icon:!0},activePage:C+1,totalPages:v,onPageChange:function(e,t){g(t.activePage-1)}})})]})},Ce=n(511),Se=n(520),Ee=n(507),Te=function(){var e=Object(l.c)((function(e){return e.db})),t=Object(l.c)((function(e){return e.codingjobs})),n=Object(l.b)(),r=Object(o.useState)("inactive"),c=Object(p.a)(r,2),a=c[0],i=c[1],s=Object(o.useState)(""),u=Object(p.a)(s,2),d=u[0],j=u[1];return t?Object(N.jsxs)(m.a,{as:Ce.a,trigger:Object(N.jsxs)(w.a,{children:[Object(N.jsx)(M.a,{name:"plus"}),"Create job"]}),onSubmit:function(t){return t.preventDefault(),j(d.trim()),i("pending"),void e.createCodingjob(d).then((function(t){e&&e.listCodingjobs().then((function(e){n(x(null)),n(v(e))})),i("inactive")})).catch((function(e){console.log(e),i("error")}))},open:"inactive"!==a,onClose:function(){return i("inactive")},onOpen:function(){j(""),i("awaiting input")},size:"tiny",children:[Object(N.jsx)(y.a,{icon:"pencil",content:"Create new Codingjob",as:"h2"}),Object(N.jsx)(m.a.Content,{children:Object(N.jsx)(Ce.a.Group,{children:Object(N.jsx)(Ce.a.Input,{width:12,label:"Name",required:!0,type:"text",value:d,onChange:function(e,t){i("awaiting input"),j(t.value)},placeholder:"Enter name"})})}),Object(N.jsxs)(m.a.Actions,{children:["error"===a?Object(N.jsx)("div",{children:"Could not create codingjob for a reason not yet covered in the error handling..."}):null,"pending"===a?Object(N.jsx)(Se.a,{active:!0,inverted:!0,children:Object(N.jsx)(Ee.a,{content:"Creating codingjob"})}):Object(N.jsx)(w.a,{type:"submit",color:"green",icon:"save",content:"Create"})]})]}):null},_e=function(){var e=Object(l.c)((function(e){return e.db})),t=Object(l.c)((function(e){return e.codingjob})),n=Object(l.b)(),r=Object(o.useState)("inactive"),c=Object(p.a)(r,2),a=c[0],i=c[1],s=function(r){i("pending"),e.deleteCodingjob(t).then((function(t){e&&e.listCodingjobs().then((function(e){n(x(null)),n(v(e))})),i("inactive")})).catch((function(e){console.log(e.message),console.log(e),i("error")}))};return t?Object(N.jsxs)(m.a,{closeIcon:!0,open:"inactive"!==a,trigger:Object(N.jsxs)(w.a,{name:"logout",children:[Object(N.jsx)(M.a,{name:"minus"})," Delete job"]}),onClose:function(){i("inactive")},onOpen:function(){i("awaiting input")},children:[Object(N.jsx)(y.a,{icon:"trash",content:"Delete codingjob ".concat(t.name)}),Object(N.jsx)(m.a.Content,{children:Object(N.jsx)("p",{children:"Do you really want to delete this codingjob?"})}),Object(N.jsxs)(m.a.Actions,{children:["error"===a?Object(N.jsx)("div",{children:"Could not delete codingjob for a reason not yet covered in the error handling..."}):null,"pending"===a?Object(N.jsx)(Se.a,{active:!0,inverted:!0,children:Object(N.jsx)(Ee.a,{content:"Creating codingjob"})}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsxs)(w.a,{color:"red",onClick:s,children:[Object(N.jsx)(M.a,{name:"remove"})," No"]}),Object(N.jsxs)(w.a,{color:"green",onClick:s,children:[Object(N.jsx)(M.a,{name:"checkmark"})," Yes"]})]})]})]}):null},Ae=function(e){var t,n=e.type,r=void 0===n?"table":n,c=Object(l.c)((function(e){return e.db})),a=Object(l.c)((function(e){return e.codingjobs})),i=Object(l.c)((function(e){return e.codingjob})),s=Object(l.b)(),u=Object(o.useState)(i),d=Object(p.a)(u,2),j=d[0],b=d[1];if(Object(o.useEffect)((function(){s(x(j))}),[i,j,s]),Object(o.useEffect)((function(){c&&i&&c.listDocuments(i).then((function(e){s(function(e){return{type:"SET_DOCUMENTS",payload:e}}(e))})).catch((function(e){console.log(e)}))}),[c,i,s]),Object(o.useEffect)((function(){c&&null===a&&c.listCodingjobs().then((function(e){s(v(e)),e.length>0&&b(Object(ce.a)(Object(ce.a)({},e[0]),{},{ROW_ID:"0"}))}))}),[c,a,s]),"table"===r){return Object(N.jsxs)(le.a,{style:{border:"0"},children:[Object(N.jsxs)(w.a.Group,{widths:"2",children:[Object(N.jsx)(Te,{}),Object(N.jsx)(_e,{})]}),Object(N.jsx)(ne.a,{style:{marginTop:"30px"},children:Object(N.jsx)(ke,{columns:[{Header:"Select Index",accessor:"name",headerClass:"thirteen wide"}],data:a||[],selectedRow:j,setSelectedRow:b,defaultSize:15})})]})}if("dropdown"===r){return Object(N.jsx)(pe.a,{clearable:!0,selection:!0,options:(t=a,t.map((function(e){return{key:e.name,text:e.name,value:e.name}}))),value:i?i.name:null,onChange:function(e,t){return function(e){if(e&&null!==a){var t=a.findIndex((function(t){return t.name===e}));b(Object(ce.a)(Object(ce.a)({},a[t]),{},{ROW_ID:t.toString()}))}else b(null)}(t.value)}})}return null},De=[{Header:"title",accessor:"title",headerClass:"six wide"},{Header:"text",accessor:"text",headerClass:"four wide"},{Header:"annotations",accessor:"annotations",headerClass:"four wide"},{Header:"meta",accessor:"meta",headerClass:"four wide"}],Ne=function(){var e=Object(l.c)((function(e){return e.codingjob})),t=Object(l.c)((function(e){return e.document})),n=Object(l.c)((function(e){return e.documents})),r=Object(l.b)(),c=Object(o.useState)(t),a=Object(p.a)(c,2),i=a[0],s=a[1];return Object(o.useEffect)((function(){r(function(e){return{type:"SELECT_ARTICLE",payload:e}}(i))}),[i,r]),e?Object(N.jsx)(ke,{columns:De,data:n,selectedRow:i,setSelectedRow:s,defaultSize:15}):null},Re=function(){return Object(N.jsx)(ne.a,{style:{marginTop:"2em"},children:Object(N.jsx)(Ne,{})})},Ie=n(506),Fe=n(300),Be=function(e){var t=e.data,n=e.codingjob,r=e.fileRef,c=Object(l.c)((function(e){return e.db})),a=Object(o.useState)([]),i=Object(p.a)(a,2),s=i[0],u=i[1],d=Object(o.useState)(null),j=Object(p.a)(d,2),h=j[0],O=j[1],x=Object(o.useState)(null),v=Object(p.a)(x,2),g=v[0],m=v[1],y=Object(o.useState)(null),k=Object(p.a)(y,2),C=k[0],S=k[1];Object(o.useEffect)((function(){if(t.length<=1)return O(null),m(null),S(null),void u([]);u(t[0].data.map((function(e){return{key:e,value:e,text:e}}))),O(t[0].data.includes("title")?"title":null),m(t[0].data.includes("text")?"text":null),S(t[0].data.includes("annotations")?"annotations":null)}),[t]);var E=function(e,t,n,r){var o=e[0].data;return e.slice(1).map((function(e){var c=e.data.reduce((function(e,c,a){var i=o[a];return i===t?e.title=c:i===n?e.text=c:i===r?e.annotations=c:e.meta[i]=c,e}),{meta:{},annotations:[]});return c.meta=JSON.stringify(c.meta,null,2),console.log(c),c}))},T=function(){var e=Object(f.a)(b.a.mark((function e(){var o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=E(t,h,g,C),e.next=4,c.createDocuments(n,o);case 4:r.current.removeFile(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return t.length<=1?null:Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(Ce.a,{children:[Object(N.jsxs)(Ce.a.Group,{children:[Object(N.jsx)(Ce.a.Field,{control:Ie.a,placeholder:"title column",options:s,value:h,onChange:function(e,t){return O(t.value)}}),Object(N.jsx)(Ce.a.Field,{control:Ie.a,placeholder:"text column",options:s,value:g,onChange:function(e,t){return m(t.value)}})]}),Object(N.jsxs)(Ce.a.Group,{children:[Object(N.jsx)(Ce.a.Field,{control:Ie.a,clearable:!0,placeholder:"annotations (optional)",options:s,value:C,onChange:function(e,t){return S(t.value)}}),Object(N.jsxs)(Ce.a.Field,{control:w.a,fluid:!0,onClick:T,disabled:!h||!g,children:[Object(N.jsx)(M.a,{name:"upload"}),"Upload"]})]})]})})},Pe=function(e){var t=e.data,n=function(e){return e.map((function(e){return Object(N.jsx)(ge.a.Cell,{children:Object(N.jsx)("span",{title:e,children:e})})}))};return t.length<=1?null:Object(N.jsxs)(ne.a,{style:{marginTop:"2em"},children:[Object(N.jsxs)(ge.a,{fixed:!0,singleLine:!0,basic:"very",children:[Object(N.jsx)(ge.a.Header,{children:Object(N.jsx)(ge.a.Row,{children:function(e){return e[0].data.map((function(e){return Object(N.jsx)(ge.a.HeaderCell,{children:Object(N.jsx)("span",{title:e,children:e})})}))}(t)})}),Object(N.jsx)(ge.a.Body,{children:function(e,t){return e.slice(0,t+1).slice(1).map((function(e){return Object(N.jsx)(ge.a.Row,{children:n(e.data)})}))}(t,5)})]}),t.length>5?Object(N.jsxs)(y.a,{align:"center",children:[t.length-1-5," more rows"]}):null]})},Ge=function(e){e.setActive;var t=Object(l.c)((function(e){return e.codingjob})),n=Object(o.useState)([]),r=Object(p.a)(n,2),c=r[0],a=r[1],i=Object(o.useRef)();return t?Object(N.jsxs)(ue.a,{style:{marginTop:"4.3em"},children:[Object(N.jsxs)(ue.a.Row,{children:[Object(N.jsxs)(ue.a.Column,{floated:"right",width:4,children:[" ",Object(N.jsx)(Fe.a,{ref:i,onFileLoad:function(e){return a(e)},addRemoveButton:!0,onRemoveFile:function(){return a([])},children:Object(N.jsx)("span",{children:"Click to upload"})})]}),Object(N.jsx)(ue.a.Column,{floated:"right",width:10,children:Object(N.jsx)(Be,{data:c,codingjob:t,fileRef:i})})]}),Object(N.jsx)(ue.a.Row,{children:Object(N.jsx)(ue.a.Column,{children:Object(N.jsx)(Pe,{data:c})})})]}):null},Le=n(306),Je=(n(485),function(e){var t=e.fields,n=e.fieldValues,r=e.setFieldValues,o=function(e,t){var o=Object(ce.a)({},n);o[e]=t,r(o)};return t?Object.keys(t).map((function(e){return"text"===t[e]?Object(N.jsx)(Ce.a.TextArea,{value:n[e]?n[e]:"",onChange:function(t,n){return o(e,n.value)},label:e},e):"date"===t[e]?Object(N.jsx)(Ce.a.Field,{children:Object(N.jsx)(Le.a,{label:e,value:n[e]?n[e]:"",onChange:function(t,n){return o(e,n.value)}},e)}):"keyword"===t[e]?Object(N.jsxs)(Ce.a.Field,{children:[Object(N.jsx)("label",{children:e}),Object(N.jsx)("input",{value:n[e]?n[e]:"",onChange:function(t){return o(e,t.target.value)}})]},e):null})):null}),ze=function(){var e=Object(l.c)((function(e){return e.db})),t=Object(l.c)((function(e){return e.codingjob})),n=Object(o.useState)({}),r=Object(p.a)(n,2),c=r[0],a=r[1];return t?Object(N.jsxs)(Ce.a,{style:{marginTop:"3em"},children:[Object(N.jsx)(Je,{fields:{title:"text",text:"text",annotations:"text"},fieldValues:c,setFieldValues:a}),t?Object(N.jsx)(w.a,{primary:!0,onClick:function(){for(var n=Object(ce.a)({},c),r=0,o=Object.keys(n);r<o.length;r++){var i=o[r];("date"===i||/_date$/.test(i))&&(n[i]=n[i].toISOString())}e.createDocuments(t,[n]).then((function(e){a({})})).catch((function(e){console.log(e)}))},children:"Create document"}):null]}):null},He=function(){var e=Object(o.useState)("details"),t=Object(p.a)(e,2),n=t[0],r=t[1];return Object(N.jsxs)(ue.a,{style:{marginTop:"3em"},children:[Object(N.jsx)(ue.a.Column,{floated:"left",width:5,children:Object(N.jsx)(Ae,{type:"table"})}),Object(N.jsx)(ue.a.Column,{width:11,children:Object(N.jsxs)(le.a,{style:{border:0},children:[Object(N.jsxs)(d.a,{pointing:!0,secondary:!0,children:[Object(N.jsx)(d.a.Item,{name:"details",active:"details"===n,onClick:function(e,t){return r(t.name)}}),Object(N.jsx)(d.a.Item,{name:"upload",active:"upload"===n,onClick:function(e,t){return r(t.name)}}),Object(N.jsx)(d.a.Item,{name:"create",active:"create"===n,onClick:function(e,t){return r(t.name)}})]}),function(e){switch(e){case"details":return Object(N.jsx)(Re,{});case"upload":return Object(N.jsx)(Ge,{});case"create":return Object(N.jsx)(ze,{});default:return null}}(n)]})})]})},Me=n(178),Ue=function(){var e=Object(f.a)(b.a.mark((function e(t,n,r){var o,c;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new Set,c=Object.values(r).reduce((function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var c=r[n],a={code:c,offset:t[c].offset,length:t[c].length},i=JSON.stringify(a);o.has(i)||(o.add(i),e.push(a))}return e}),[]),e.next=4,t.writeValue({doc_id:n.doc_id},"annotations",JSON.stringify(c,null,2));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Ve=function(e,t,n){var r,o={},c=[],a=Object(Me.a)(e);try{for(a.s();!(r=a.n()).done;){var i=r.value;qe(i,t,o,c)}}catch(l){a.e(l)}finally{a.f()}for(var s=0,u=c;s<u.length;s++){Ye(u[s],n)}},qe=function(e,t,n,r){for(var o=e.offset.start,c=e.offset.start+e.offset.length,a=o;a<=c;a++)if(t[a]){var i,s=Object(Me.a)(t[a].start);try{for(s.s();!(i=s.n()).done;){var u=i.value;n[u]={index:e.offset.index,group:u,offset:o,length:null,span:[e.offset.index]}}}catch(b){s.e(b)}finally{s.f()}var l,d=Object(Me.a)(t[a].end);try{for(d.s();!(l=d.n()).done;){var j=l.value;n[j].span.push(e.offset.index),n[j].length=e.offset.start+e.offset.length-n[j].offset,r.push(n[j]),delete n[j]}}catch(b){d.e(b)}finally{d.f()}}},Ye=function(e,t){for(var n=[],r=e.span[0];r<=e.span[1];r++){var o=Object(ce.a)({},e);o.index=r,n.push(o)}t(g(n))},Ke=function(e){var t=e.tokens,n=e.doc,r=Object(l.c)((function(e){return e.db})),c=Object(l.c)((function(e){return e.spanAnnotations})),a=Object(o.useState)(!1),i=Object(p.a)(a,2),s=i[0],u=i[1],d=Object(l.b)();return Object(o.useEffect)((function(){u(!1)}),[n]),Object(o.useEffect)((function(){t&&n.annotations&&(Ve(t,n.annotations,d),u(!0))}),[t,n,d]),Object(o.useEffect)((function(){s&&Ue(r,n,c)}),[s,r,n,c]),Object(N.jsx)("div",{})},We=(n(486),n(305)),Xe=n(510),Ze=n(514),$e=n(516),Qe=n(303),et=n.n(Qe),tt=function(e){var t=e.index,n=e.children,r=Object(l.c)((function(e){return e.codes})),c=Object(l.c)((function(e){return e.codeHistory})),a=Object(l.c)((function(e){return e.spanAnnotations})),i=Object(o.useRef)(null),s=Object(o.useState)(null),u=Object(p.a)(s,2),d=u[0],j=u[1],b=!0,f=Object(l.b)();Object(o.useEffect)((function(){var e=a[t];e&&void 0!==e&&(Object.keys(e).includes("Not yet assigned")?j("Not yet assigned"):j(Object.keys(e)[0]))}),[t,a]);var h=function(e){e?window.addEventListener("keydown",O):window.removeEventListener("keydown",O)},O=function(e){i.current&&i.current.click()},x=function(e,t){var n=t.find((function(t){return t.value===e}));return n?n.color:"lightgrey"},v=function(e){var n=d,r=a[t];if(!r)return null;var o={index:r[n].index,group:n,offset:r[n].offset,length:r[n].length,span:r[n].span},c=Object(ce.a)({},o);if(c.span=[c.index,c.index],f({type:"RM_ANNOTATIONS",payload:[c]}),e===n)return null;for(var i=[],s=o.span[0];s<=o.span[1];s++){var u=Object(ce.a)({},o);u.group=e,u.index=s,i.push(u)}f(g(i)),f(function(e){return{type:"APPEND_CODE_HISTORY",payload:{code:e,n:arguments.length>1&&void 0!==arguments[1]?arguments[1]:5}}}(e)),Object.keys(r).includes(null)?j(null):j(e)},m=function(e){var t=e;return e&&"null"!==e||(t="Not yet assigned"),{key:t,text:t,value:t}};return Object(N.jsx)(Xe.a,{trigger:n,on:"hover",flowing:!0,hoverable:!0,wide:!0,onOpen:function(){return h(!0)},onClose:function(){return h(!1)},position:"top left",children:Object(N.jsx)("div",{children:Object(N.jsxs)(Ze.a.Group,{vertical:!0,children:[Object(N.jsx)(Ze.a,{active:!0,children:Object(N.jsxs)(Ze.a.Content,{children:[Object(N.jsx)(Ze.a.Title,{children:"Current code"}),Object(N.jsx)(Ze.a.Description,{children:Object(N.jsxs)(w.a.Group,{children:[Object(N.jsx)(w.a,{icon:"trash",size:"mini",onClick:function(e,t){return v(d)}}),Object(N.jsx)(w.a,{style:{backgroundColor:x(d,r)},children:Object(N.jsx)(pe.a,{text:d,options:function(){var e=a[t];return e?Object.keys(e).filter((function(e){return e!==d})).map(m):[m(null)]}(),value:d,onChange:function(e,t){return j(t.value)}})})]})})]})}),Object(N.jsx)(Ze.a,{children:Object(N.jsxs)(Ze.a.Content,{children:[Object(N.jsx)(Ze.a.Title,{children:"Set new code"}),Object(N.jsxs)(Ze.a.Description,{children:[Object(N.jsx)(w.a.Group,{vertical:!0,compact:!0,widths:"1",children:c.filter((function(e){return e!==d&&"Not yet assigned"!==e})).map((function(e){return Object(N.jsx)(w.a,{style:{backgroundColor:x(e,r)},value:e,onClick:function(e,t){return v(t.value)},children:e},e)}))}),"\xa0\xa0",Object(N.jsx)($e.a,{innerRef:i,children:Object(N.jsx)(pe.a,{compact:!0,options:r,placeholder:b?"Search or create ":"Search ",widths:1,search:!0,selection:!0,allowAdditions:b,additionPosition:"bottom",onAddItem:function(e,t){f(function(e){return{type:"SET_CODES",payload:e}}([{key:t.value,text:t.value,value:t.value,color:et()({seed:t.value,luminosity:"bright"})}].concat(Object(We.a)(r))))},selectOnNavigation:!1,minCharacters:0,autoComplete:"on",searchInput:{autoFocus:!1},onChange:function(e,t){return v(t.value)}})})]})]})})]})})})},nt=function(e){var t=e.token;return Object(N.jsx)("span",{className:"token",tokenindex:t.offset.index,tokenoffset:t.offset.start,tokenlength:t.offset.length,children:Object(N.jsx)(rt,{token:t})})},rt=c.a.memo((function(e){var t=e.token,n=Object(l.c)((function(e){return e.spanAnnotations[t.offset.index]})),r=Object(l.c)((function(e){return e.codes}));if(Object(l.c)((function(e){return JSON.stringify(e.spanAnnotations[t.offset.index])})),!n)return Object(N.jsx)(N.Fragment,{children:t.pre+t.text+t.post});var o=function(e,t){var n=t.find((function(t){return t.value===e}));return n?n.color:"lightgrey"},c=Object.keys(n),a=null;if(1===c.length)a=o(c[0],r);else{var i=c.map((function(e){return o(e,r)}));a="linear-gradient(".concat(i.join(", "),")")}var s=!Object.values(n).some((function(e){return e.span[0]!==e.index})),u=!Object.values(n).some((function(e){return e.span[1]!==e.index})),d="TextCodeBubble";return s&&(d+=" allLeft"),Object.values(n).some((function(e){return e.span[0]===e.index}))&!s&&(d+=" anyLeft"),u&&(d+=" allRight"),Object.values(n).some((function(e){return e.span[1]===e.index}))&!u&&(d+=" anyRight"),Object(N.jsxs)(N.Fragment,{children:[s?t.pre:null,Object(N.jsx)(tt,{index:t.offset.index,children:Object(N.jsxs)("span",{className:d,style:{background:a},children:[s&&u?t.text:null,s&&!u?t.text+t.post:null,u&&!s?t.pre+t.text:null,s||u?null:t.pre+t.text+t.post]})}),u?t.post:null]})})),ot=c.a.memo(nt),ct=n(219),at=n(304);ct.a.extend(at.a);var it=function(e){var t=e.text,n=e.setTokens,r=Object(o.useState)(null),c=Object(p.a)(r,2),a=c[0],i=c[1];return Object(o.useEffect)((function(){var e=st(t),r=Object(p.a)(e,2),o=r[0],c=r[1];i(o),n(c)}),[t,n]),null===t?null:Object(N.jsx)(ne.a,{text:!0,children:a})},st=function(e){var t=[];return[ct.a.tokenize(e).paragraphs().json({offset:!0}).map((function(e,n){return ut(e,n,t)})),t]},ut=function(e,t,n){var r=function(e){return e.sentences.map((function(e){return e.map((function(e){return lt(e,n)}))}))};return Object(N.jsx)("span",{style:{marginTop:"1em",display:"table"},children:0===t?Object(N.jsx)("h2",{children:r(e)}):r(e)},t)},lt=function(e,t){return Object(N.jsx)("span",{className:"sentence",children:function(e){return e.terms.map((function(e){return t.push(e),Object(N.jsx)(ot,{token:e},e.offset.index)}))}(e)},e.offset.index)},dt=c.a.memo(it),jt=function(e){return{index:parseInt(e.getAttribute("tokenindex")),offset:parseInt(e.getAttribute("tokenoffset")),length:parseInt(e.getAttribute("tokenlength"))}},bt=function(e){return console.log(e),"token"===e.className?jt(e):e.parentNode&&"token"===e.parentNode.className?jt(e.parentNode):null},ft=function(e){var t=e.doc,n=Object(l.c)((function(e){return e.codeHistory})),r=Object(o.useState)([]),c=Object(p.a)(r,2),a=c[0],i=c[1],s=Object(l.b)();Object(o.useEffect)((function(){s({type:"CLEAR_SPAN_ANNOTATIONS"})}),[t,s]),Object(o.useEffect)((function(){return window.addEventListener("keydown",u),function(){window.removeEventListener("keydown",u)}})),Object(o.useEffect)((function(){return window.addEventListener("mouseup",d),function(){window.removeEventListener("mouseup",d)}}));var u=function(e){console.log(e.key)},d=function(e){if(1!==e.which)return null;var t=window.getSelection();if(!t.anchorNode||!t.focusNode)return null;var r=bt(t.anchorNode.parentElement),o=bt(t.focusNode.parentElement);if(!r||!o)return null;if(window.getSelection().empty(),r.index>o.index){var c=[o,r];r=c[0],o=c[1]}var a=n[0]?n[0]:null;e.ctrlKey||(a="Not yet assigned");for(var i=[],u=r.index;u<=o.index;u++)i.push({index:u,group:a,offset:r.offset,length:o.offset+o.length-r.offset,span:[r.index,o.index]});s(g(i))};return t?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)(dt,{text:t.text,setTokens:i}),Object(N.jsx)(Ke,{tokens:a,doc:t})]}):null},pt=[{label:"Create",path:"/create",Component:He},{label:"Annotate",path:"/annotate",Component:function(){var e=Object(l.c)((function(e){return e.db})),t=Object(l.c)((function(e){return e.codingjob})),n=Object(o.useState)(null),r=Object(p.a)(n,2),c=r[0],a=r[1],i=Object(o.useState)([]),s=Object(p.a)(i,2),u=s[0],d=s[1];Object(o.useEffect)((function(){e&&t&&e.listDocuments(t).then((function(e){d(e)})).catch((function(e){console.log(e)}))}),[e,t]);var j=function(){var t=Object(f.a)(b.a.mark((function t(n){var r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDocument(n);case 2:r=t.sent,a({doc_id:r.doc_id,text:r.title+"\n\n"+r.text,annotations:(o=r.annotations,o?JSON.parse(o).reduce((function(e,t){return e[t.offset]||(e[t.offset]={start:[],end:[]}),e[t.offset+t.length]||(e[t.offset+t.length]={start:[],end:[]}),e[t.offset].start.push(t.code),e[t.offset+t.length].end.push(t.code),e}),{}):{})});case 4:case"end":return t.stop()}var o}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(N.jsx)(N.Fragment,{children:Object(N.jsxs)(ue.a,{children:[Object(N.jsxs)(ue.a.Row,{children:[Object(N.jsx)(Ae,{type:"dropdown"}),Object(N.jsx)(pe.a,{selection:!0,onChange:function(e,t){j(t.value)},options:function(e){return e.map((function(e,t){return{key:t,text:e.title,value:e.doc_id}}))}(u)})]}),Object(N.jsxs)(ue.a.Row,{children:[Object(N.jsx)(ue.a.Column,{width:12,children:Object(N.jsx)(ft,{doc:c||null})}),Object(N.jsx)(ue.a.Column,{width:4,children:Object(N.jsx)(tt,{})})]})]})})}}],ht=function(){var e;return Object(N.jsxs)(s.a,{children:[Object(N.jsx)(ee,{items:pt}),Object(N.jsx)(te.a,{}),Object(N.jsx)(ne.a,{style:{marginTop:"3em"},children:Object(N.jsxs)(u.d,{children:[Object(N.jsx)(u.b,{exact:!0,path:"/",render:function(){return Object(N.jsx)(je,{items:pt})}}),(e=pt,e.map((function(e){return Object(N.jsx)(fe,{path:e.path,Component:e.Component},e.path)})))]})})]})},Ot=n(96),xt=function(e,t,n){for(var r in t){var o=t[r];if(e[o.index]&&e[o.index][o.group]){for(var c=e[o.index][o.group].span,a=c[0];a<=c[1];a++)e[a]&&e[a][o.group]&&(delete e[a][o.group],0===Object.keys(e[a]).length&&delete e[a]);if(o.span[0]===o.span[1])continue}n||(e[o.index]||(e[o.index]={}),e[o.index][o.group]={index:o.index,span:[o.span[0],o.span[1]],offset:o.offset,length:o.length})}return e},vt=[{key:"Mark Rutte",text:"Mark Rutte",value:"Mark Rutte",color:"#40a31f"},{key:"Sigrid Kaag",text:"Sigrid Kaag",value:"Sigrid Kaag",color:"#f2db5c"}],gt=Object(Ot.b)({db:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DB":return t.payload;case"RESET_DB":return null;default:return e}},dropbox:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DROPBOX":return console.log("set dropbox"),t.payload;case"RESET_DB":return null;default:return e}},codingjob:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_CODINGJOB":return t.payload;case"RESET_DB":return null;default:return e}},codingjobs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CODINGJOBS":return t.payload;case"RESET_DB":return null;default:return e}},document:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_DOCUMENT":return t.payload;case"RESET_DB":return[];default:return e}},documents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DOCUMENTS":return t.payload;case"RESET_DB":return[];default:return e}},tokenIndices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN_INDICES":return t.payload;case"RESET_DB":return null;default:return e}},spanAnnotations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_ANNOTATIONS":return xt(Object(ce.a)({},e),t.payload,!1);case"RM_ANNOTATIONS":return xt(Object(ce.a)({},e),t.payload);case"CLEAR_SPAN_ANNOTATIONS":case"RESET_DB":return{};default:return e}},codes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CODES":return t.payload;case"RESET_DB":return[];default:return e}},codeHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APPEND_CODE_HISTORY":var n=e.filter((function(e){return e!==t.payload.code})).slice(0,t.payload.n-1);return n.unshift(t.payload.code),n;case"RESET_DB":return[];default:return e}}}),mt=Object(Ot.c)(gt);i.a.render(Object(N.jsx)(c.a.StrictMode,{children:Object(N.jsx)(l.a,{store:mt,children:Object(N.jsx)(ht,{})})}),document.querySelector("#root"))}},[[487,1,2]]]);
//# sourceMappingURL=main.95244831.chunk.js.map