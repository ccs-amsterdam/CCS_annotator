(this.webpackJsonpamcat4annotator=this.webpackJsonpamcat4annotator||[]).push([[0],{331:function(e,t){},333:function(e,t){},343:function(e,t){},345:function(e,t){},371:function(e,t){},373:function(e,t){},374:function(e,t){},379:function(e,t){},381:function(e,t){},400:function(e,t){},412:function(e,t){},415:function(e,t){},463:function(e,t,n){var r={"./bg-BG.json":464,"./ca-ES.json":465,"./cs-CZ.json":466,"./de-DE.json":467,"./en-US.json":284,"./es-ES.json":468,"./et-EE.json":469,"./fi-FI.json":470,"./fr-FR.json":471,"./he-IL.json":472,"./it-IT.json":473,"./ja-JP.json":474,"./ko-KR.json":475,"./nb-NO.json":476,"./nn-NO.json":477,"./pl-PL.json":478,"./pt-BR.json":479,"./ru-RU.json":480,"./sv-SE.json":481,"./tr-TR.json":482,"./zh-CN.json":483};function o(e){var t=a(e);return n(t)}function a(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id=463},485:function(e,t,n){},486:function(e,t,n){"use strict";n.r(t);n(316);var r=n(0),o=n.n(r),a=n(59),c=n.n(a),i=n(82),s=n(18),u=n(8),l=n(518),d=n(13),j=n.n(d),b=n(17),f=n(11),p=function(e){return{type:"SET_DB",payload:e}},h=function(e){return{type:"SET_DROPBOX",payload:e}},O=function(e){return{type:"SELECT_CODINGJOB",payload:e}},x=function(e){return{type:"SET_CODINGJOBS",payload:e}},g=function(e){return{type:"TOGGLE_ANNOTATIONS",payload:e}},v=n(512),m=n(514),y=n(487),w=n(141),k=n(142),C=n(206),S=n(290),E=n.n(S),T=function(){function e(t,n){Object(w.a)(this,e),this.dbx=t,this.user=n}return Object(k.a)(e,[{key:"readJSON",value:function(e){this.dbx.filesDownload({path:"/".concat(this.user.email,"/").concat(e)})}},{key:"writeJSON",value:function(e,t){var n=new File(e,t,{type:"application/json"});this.dbx.filesUpload({path:"/".concat(this.user.email,"/").concat(n.name),contents:n})}}]),e}(),_=function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.setAccessToken(n),r=new C.Dropbox({auth:t}),e.next=4,r.usersGetCurrentAccount();case 4:return o=e.sent,e.abrupt("return",new T(r,o.result));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(b.a)(j.a.mark((function e(t,n,r){var o,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=window.sessionStorage.getItem("codeVerifier"),t.setCodeVerifier(o),e.next=4,t.generateCodeChallenge();case 4:return e.next=6,t.getAccessTokenFromCode(r,n);case 6:return a=e.sent,e.abrupt("return",{token:a.result.access_token,refresh_token:a.result.refresh_token,expiration_date:Date.now()+1e3*a.result.expires_in});case 8:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),D=n(1),N=function(){var e=Object(r.useState)(!1),t=Object(f.a)(e,2),n=t[0],o=t[1],a=Object(u.c)((function(e){return e.dropbox})),c=Object(u.b)(),i=Object(u.c)((function(e){return e.db}));return Object(D.jsxs)(v.a,{closeIcon:!0,open:n,trigger:Object(D.jsx)(l.a.Item,{icon:"dropbox",name:"Sync",style:{color:"lightblue"}}),onClose:function(){return o(!1)},onOpen:function(){return o(!0)},children:[Object(D.jsx)(m.a,{icon:"dropbox",content:"Synchronize with Dropbox"}),Object(D.jsx)(v.a.Content,{children:Object(D.jsx)("p",{children:"Something about synchronization."})}),Object(D.jsxs)(v.a.Actions,{children:[Object(D.jsx)(y.a,{primary:!0,onClick:function(){a.writeJSON(["test"],"test.json")},children:"Synchronize"}),Object(D.jsx)(y.a,{primary:!0,onClick:function(){i&&i.deleteToken("dropbox"),c(h(null))},children:"Disconnect"})]})]})},R=function(e){var t=e.homepage,n=Object(r.useState)(),o=Object(f.a)(n,2),a=o[0],c=o[1],i=Object(u.c)((function(e){return e.dropbox})),d=Object(u.c)((function(e){return e.db})),p=Object(r.useState)(!0),O=Object(f.a)(p,2),x=O[0],g=O[1],w=Object(u.b)(),k=Object(s.g)(),S="/create",T=t+S,R=function(e){return new C.DropboxAuth({clientId:e})}("doge8b5gywmaz6x");Object(r.useEffect)((function(){if(console.log("listen"),!i&&d){var e=function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_(R,t.token);case 3:return n=e.sent,e.next=6,d.addToken("dropbox",t);case 6:return e.next=8,w(h(n));case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}();x&&(g(!1),d.getToken("dropbox").then((function(t){t&&t.token&&(Date.now()>t.expiration_date?(console.log("Trying refresh"),R.setRefreshToken(t.refresh_token),R.refreshAccessToken().then(e)):e(t))})));var t=E.a.parse(window.location.search).code;t&&A(R,t,T).then(e).then((function(){k.push(S)})).catch((function(e){return console.log(e)}))}}),[i,d,x,w,k]);return d?i?Object(D.jsx)(N,{}):Object(D.jsxs)(v.a,{closeIcon:!0,open:a,trigger:Object(D.jsx)(l.a.Item,{icon:"dropbox",name:"Connect"}),onClose:function(){return c(!1)},onOpen:function(){return c(!0)},children:[Object(D.jsx)(m.a,{icon:"dropbox",content:"Connect to Dropbox"}),Object(D.jsxs)(v.a.Content,{children:[Object(D.jsx)("p",{children:"This app connects with Dropbox using OAuth 2.0 authorization with PKCE flow. Your will exchange your data directly with Dropbox, so we can't touch it. (So we also can't help you if you lose it)"}),Object(D.jsx)("p",{children:"As Dropbox will also tell you, this app will only have read/write access to the Apps/AmCAT_Annotator folder in your dropbox. So even if you don't trust us we're quite harmless."})]}),Object(D.jsx)(v.a.Actions,{children:Object(D.jsx)(y.a,{primary:!0,onClick:function(){!function(e,t){e.getAuthenticationUrl(t,void 0,"code","offline",void 0,void 0,!0).then((function(t){window.sessionStorage.clear(),window.sessionStorage.setItem("codeVerifier",e.codeVerifier),window.location.href=t})).catch((function(e){return console.error(e)}))}(R,T)},children:"Authenticate"})})]}):null},I=n(293),F=n(294),B=n.n(F);function P(e){var t=e.totalRows,n=e.completedRows;console.log("Progress: ".concat(n," of ").concat(t," rows completed"))}var G=function(){var e=Object(r.useState)(!1),t=Object(f.a)(e,2),n=t[0],o=t[1],a=Object(u.c)((function(e){return e.db})),c=function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log(a),e.next=4,Object(I.a)(a.idb,{filter:function(e,t,n){return"codingjobs"===e||"documents"===e},prettyJson:!0,progressCallback:P});case 4:t=e.sent,B()(t,"AmCAT_Annotator.json"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(""+e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(){return e.apply(this,arguments)}}();return Object(D.jsxs)(v.a,{closeIcon:!0,open:n,trigger:Object(D.jsx)(l.a.Item,{icon:"download",name:"Download",style:{color:"lightgreen"}}),onClose:function(){return o(!1)},onOpen:function(){return o(!0)},children:[Object(D.jsx)(m.a,{icon:"dropbox",content:"Download everything"}),Object(D.jsx)(v.a.Content,{children:Object(D.jsx)("p",{children:"Download all data as a single JSON dump"})}),Object(D.jsx)(v.a.Actions,{children:Object(D.jsx)(y.a,{primary:!0,onClick:c,children:"Download"})})]})},L=n(79),J=function(e){var t=e.homepage,n=Object(u.c)((function(e){return e.db})),o=Object(u.b)(),a=Object(r.useState)(!1),c=Object(f.a)(a,2),i=c[0],d=c[1],j=Object(s.g)();return n?Object(D.jsxs)(v.a,{closeIcon:!0,open:i,trigger:Object(D.jsx)(l.a.Item,{icon:"rocket",name:"Reset",style:{color:"#d7a3a3"}}),onClose:function(){return d(!1)},onOpen:function(){return d(!0)},children:[Object(D.jsx)(m.a,{icon:"power off",content:"Reset Annotator Database"}),Object(D.jsx)(v.a.Content,{children:Object(D.jsx)("p",{children:"This will remove all document and annotation data from your browser. Any annotations that have not been saved/synchronized will be lost. Are you absolutely sure?"})}),Object(D.jsxs)(v.a.Actions,{children:[Object(D.jsxs)(y.a,{color:"red",onClick:function(){d(!1)},children:[Object(D.jsx)(L.a,{name:"remove"})," No"]}),Object(D.jsxs)(y.a,{color:"green",onClick:function(){console.log(n),n.deleteDB().then((function(){o({type:"RESET_DB"}),d(!1),j.push(t)})).catch((function(e){console.log(e)}))},children:[Object(D.jsx)(L.a,{name:"checkmark"})," Yes"]})]})]}):null};function z(){return H.apply(this,arguments)}function H(){return(H=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y();case 2:t=e.sent,e.t0=t,e.next="never"===e.t0?6:"persisted"===e.t0?8:"prompt"===e.t0?10:12;break;case 6:return console.log("Not possible to persist storage"),e.abrupt("break",13);case 8:return console.log("Successfully persisted storage silently"),e.abrupt("break",13);case 10:return console.log("Not persisted, but we may prompt user when we want to."),e.abrupt("break",13);case 12:console.log("compiler desperately wanted a default");case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return U.apply(this,arguments)}function U(){return(U=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.storage;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=navigator.storage.persist;case 5:if(!e.t0){e.next=9;break}e.t1=navigator.storage.persist(),e.next=10;break;case 9:e.t1=void 0;case 10:return e.abrupt("return",e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return q.apply(this,arguments)}function q(){return(q=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.storage;case 2:if(e.t0=e.sent,!e.t0){e.next=5;break}e.t0=navigator.storage.persisted;case 5:if(!e.t0){e.next=9;break}e.t1=navigator.storage.persisted(),e.next=10;break;case 9:e.t1=void 0;case 10:return e.abrupt("return",e.t1);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return K.apply(this,arguments)}function K(){return(K=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.storage&&navigator.storage.persisted){e.next=2;break}return e.abrupt("return","never");case 2:return e.next=4,navigator.storage.persisted();case 4:if(!e.sent){e.next=7;break}return e.abrupt("return","persisted");case 7:if(navigator.permissions&&navigator.permissions.query){e.next=9;break}return e.abrupt("return","prompt");case 9:return e.next=11,navigator.permissions.query({name:"persistent-storage"});case 11:if("granted"!==(t=e.sent).state){e.next=21;break}return e.next=15,navigator.storage.persist();case 15:if(!e.sent){e.next=20;break}return e.abrupt("return","persisted");case 20:throw new Error("Failed to persist");case 21:if("prompt"!==t.state){e.next=23;break}return e.abrupt("return","prompt");case 23:return e.abrupt("return","never");case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var W=function(){var e=Object(r.useState)(!1),t=Object(f.a)(e,2),n=t[0],o=t[1],a=Object(r.useState)(!1),c=Object(f.a)(a,2),i=c[0],s=c[1];Object(r.useEffect)((function(){i||V().then(s)}),[i]);var u=function(){var e=Object(b.a)(j.a.mark((function e(){return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M();case 2:return e.next=4,V();case 4:e.sent?(s(!0),alert("indexedDB set to persistent for AmCAT Annotator")):alert("Failed to set indexedDB to persistent");case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i?null:Object(D.jsxs)(v.a,{closeIcon:!0,open:n,trigger:Object(D.jsx)(l.a.Item,{icon:"database",name:"Enable persitance",style:{color:"#d7a3a3"}}),onClose:function(){return o(!1)},onOpen:function(){return o(!0)},children:[Object(D.jsx)(m.a,{icon:"database",content:"Set database persistence"}),Object(D.jsxs)(v.a.Content,{children:[Object(D.jsx)("p",{children:"We did not have permission to automatically make the data storage for this website persistent. This means that the data could be removed automatically by your browser if it needs to free up space for another website. You can try to set this manually here, but not all browsers support this (yet)."}),Object(D.jsx)("p",{children:"If the database is not persistent the app can still be used, but you need to be more carefull in making sure that data is regularly backed up, either by manually downloading data or syncing with Dropbox"})]}),Object(D.jsx)(v.a.Actions,{children:Object(D.jsxs)(y.a,{onClick:u,children:[Object(D.jsx)(L.a,{name:"checkmark"})," Yes"]})})]})},X=Object(s.i)((function(e){var t=e.items,n=e.homepage,r=Object(u.c)((function(e){return e.db})),o=Object(s.h)(),a=t.map((function(e,t){return Object(D.jsx)(l.a.Item,{index:t,as:i.b,to:e.path,header:0===t,disabled:!r,active:e.path===o.pathname,children:e.label},"item-"+t)}));return Object(D.jsxs)(l.a,{fixed:"top",inverted:!0,children:[a,Object(D.jsxs)(l.a.Menu,{position:"right",children:[Object(D.jsx)(R,{homepage:n}),Object(D.jsx)(G,{}),Object(D.jsx)(W,{}),Object(D.jsx)(J,{homepage:n})]})]})})),Z=n(508),$=n(507),Q=n(103),ee=n(160),te=n(15),ne=n(210),re=n.n(ne),oe=function(){function e(){Object(w.a)(this,e),this.idb=new Q.a("AmCAT_Annotator"),this.idb.version(1).stores({apis:"api",codingjobs:"job_id, name",documents:"doc_id, job_id"})}return Object(k.a)(e,[{key:"addToken",value:function(e,t){return this.idb.apis.put({api:e,token:t.token,refresh_token:t.refresh_token,expiration_date:t.expiration_date})}},{key:"deleteToken",value:function(e){return this.idb.apis.delete(e)}},{key:"getToken",value:function(e){return this.idb.apis.get(e)}},{key:"createCodingjob",value:function(e){var t=re()([e,Date.now().toString()]);return this.idb.codingjobs.add({job_id:t,name:e})}},{key:"deleteCodingjob",value:function(){var e=Object(b.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.listDocuments(t);case 2:return n=e.sent,e.next=5,this.deleteDocuments(n);case 5:return e.abrupt("return",this.idb.codingjobs.delete(t.job_id));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listCodingjobs",value:function(){return this.idb.codingjobs.toArray()}},{key:"getCodingjob",value:function(e){return this.idb.codingjobs.get("name").equals(e)}},{key:"createDocuments",value:function(){var e=Object(b.a)(j.a.mark((function e(t,n){var r,o,a,c;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Set,e.next=3,this.idb.documents.where("job_id").equals(t.job_id).primaryKeys();case 3:return e.t1=e.sent,r=new e.t0(e.t1),o=0,a=n.reduce((function(e,n){var a=re()([n,t]);if(r.has(a))o++;else{if(r.add(a),n.annotations&&n.annotations.length>0){console.log(n.annotations);try{JSON.parse(n.annotations)}catch(c){throw alert("Annotations field contains invalid JSON"),new Error("JSON parse error")}}e.push(Object(te.a)({doc_id:a,job_id:t.job_id},n))}return e}),[]),c="Created ".concat(n.length-o," new documents in codingjob ").concat(t.name,"."),o>0&&(c+=" Ignored ".concat(o," duplicates")),alert(c),e.abrupt("return",this.idb.documents.bulkAdd(a));case 11:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"deleteDocuments",value:function(e){var t=e.map((function(e){return e.doc_id}));return this.idb.documents.bulkDelete(t)}},{key:"listDocuments",value:function(e){return this.idb.documents.where("job_id").equals(e.job_id).toArray()}},{key:"getDocument",value:function(e){return this.idb.documents.get(e)}},{key:"writeValue",value:function(e,t,n){return this.idb.documents.where("doc_id").equals(e.doc_id).modify(Object(ee.a)({},t,n))}},{key:"deleteDB",value:function(){return this.idb.delete()}}]),e}(),ae=n(516),ce=n(517),ie=function(e){var t=e.items,n=Object(u.b)(),r=Object(s.g)(),o=function(){var e=Object(b.a)(j.a.mark((function e(){var o;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("teeeeeeeeeeeeeeeeeest"),e.next=4,new oe;case 4:return o=e.sent,n(p(o)),e.next=8,z();case 8:r.push(t[0].path),e.next=13;break;case 11:e.prev=11,e.t0=e.catch(0);case 13:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}();return Q.a.exists("AmCAT_Annotator").then((function(e){e&&o()})),Object(D.jsx)(ae.a,{inverted:!0,textAlign:"center",style:{height:"100vh"},verticalAlign:"middle",children:Object(D.jsx)(ae.a.Column,{style:{maxWidth:450},children:Object(D.jsxs)(ce.a,{style:{border:0},children:[Object(D.jsx)(m.a,{as:"h2",textAlign:"center",children:"Welcome to the AmCAT annotator"}),Object(D.jsx)("p",{children:"This is the (early development version of the) AmCAT annotator. The fact that you see this message means that you're either here for the first time, or your local annotation database was reset (by you or your browser)."}),Object(D.jsx)("p",{children:"The annotator stores your codingjobs and annotations on your local computer in your browser's IndexedDB. Your data will only actually touch the internet when you synchronize your data. Currently we've implemented syncronization with Dropbox. This way we have nothing to do with your data."}),Object(D.jsx)(y.a,{primary:!0,onClick:o,children:"Yes, off course I trust you"})]})})})},se=n(303),ue=function(e){var t=e.Component,n=e.homepage,r=Object(se.a)(e,["Component","homepage"]),o=Object(u.b)(),a=function(){var e=Object(b.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new oe;case 2:t=e.sent,o(p(t));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Q.a.exists("AmCAT_Annotator").then((function(e){if(a(),!e)return Object(D.jsx)(s.a,{to:n})})),Object(D.jsx)(s.b,Object(te.a)(Object(te.a)({},r),{},{render:function(e){return Object(D.jsx)(t,Object(te.a)(Object(te.a)({},r),e))}}))},le=n(132),de=n(131),je=n(295),be=n(116),fe=n(104),pe=n(521),he=n(127),Oe=n(211),xe=n(522),ge=function(e){var t=e.columns,n=e.data,o=e.selectedRow,a=e.setSelectedRow,c=e.defaultSize,i=void 0===c?15:c,s=Object(r.useState)(o?o.ROW_ID:null),u=Object(f.a)(s,2),l=u[0],d=u[1],j=Object(de.useTable)({columns:t,data:n,initialState:{pageSize:i,globalFilter:""}},de.useGlobalFilter,de.useSortBy,de.usePagination),b=j.getTableProps,p=j.getTableBodyProps,h=j.headerGroups,O=j.prepareRow,x=j.page,g=j.pageCount,v=j.gotoPage,m=j.setPageSize,y=j.preGlobalFilteredRows,w=j.setGlobalFilter,k=j.state,C=k.pageIndex,S=k.globalFilter;Object(r.useEffect)((function(){d(o?o.ROW_ID:null)}),[o]);var E=function(e){var t=e.preGlobalFilteredRows,n=e.globalFilter,r=e.setGlobalFilter,o=t&&t.length;return Object(D.jsx)("span",{children:Object(D.jsx)("input",{value:n||"",onChange:function(e){r(e.target.value||void 0)},placeholder:"Search ".concat(o," records..."),style:{border:"0"}})})},T=function(e){return e.headers.map((function(e){return Object(D.jsxs)(je.a,Object(te.a)(Object(te.a)({className:e.headerClass},e.getHeaderProps(e.getSortByToggleProps())),{},{children:[e.render("Header"),Object(D.jsx)("span",{children:e.isSorted?e.isSortedDesc?" \ud83d\udd3d":" \ud83d\udd3c":""})]}))}))};return 0===n.length?null:Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(E,{preGlobalFilteredRows:y,globalFilter:S,setGlobalFilter:w}),Object(D.jsxs)(pe.a,Object(te.a)(Object(te.a)({striped:!0,fixed:!0,singleLine:!0,selectable:!0},b()),{},{children:[Object(D.jsx)(he.a,{children:h.map((function(e){return Object(D.jsx)(be.a,Object(te.a)(Object(te.a)({},e.getHeaderGroupProps()),{},{children:T(e)}))}))}),Object(D.jsx)(Oe.a,Object(te.a)(Object(te.a)({},p()),{},{children:function(e){return e.map((function(e,t){return O(e),Object(D.jsx)(be.a,Object(te.a)(Object(te.a)({active:!!l&&l===e.id,onClick:function(){return function(e){l&&l===e.id?(a(null),d(null)):(a(Object(te.a)(Object(te.a)({},n[e.id]),{},{ROW_ID:e.id})),d(e.id))}(e)}},e.getRowProps()),{},{children:e.cells.map((function(e){return Object(D.jsx)(fe.a,Object(te.a)(Object(te.a)({title:e.value},e.getCellProps()),{},{children:e.render("Cell")}))}))}))}))}(x)}))]})),Object(D.jsx)(le.a,{text:"show per page",options:[10,25,50,100,500].map((function(e){return{value:e,text:e}})),onChange:function(e,t){m(t.value)}}),Object(D.jsx)("div",{style:{marginTop:"3em",display:"flex",justifyContent:"flex-end"},children:Object(D.jsx)(xe.a,{style:{border:"0"},size:"mini",firstItem:!1,lastItem:!1,nextItem:!1,prevItem:!1,boundaryRange:1,ellipsisItem:{content:Object(D.jsx)(L.a,{name:"ellipsis horizontal"}),icon:!0},activePage:C+1,totalPages:g,onPageChange:function(e,t){v(t.activePage-1)}})})]})},ve=n(510),me=n(519),ye=n(506),we=function(){var e=Object(u.c)((function(e){return e.db})),t=Object(u.c)((function(e){return e.codingjobs})),n=Object(u.b)(),o=Object(r.useState)("inactive"),a=Object(f.a)(o,2),c=a[0],i=a[1],s=Object(r.useState)(""),l=Object(f.a)(s,2),d=l[0],j=l[1];return t?Object(D.jsxs)(v.a,{as:ve.a,trigger:Object(D.jsxs)(y.a,{children:[Object(D.jsx)(L.a,{name:"plus"}),"Create job"]}),onSubmit:function(t){return t.preventDefault(),j(d.trim()),i("pending"),void e.createCodingjob(d).then((function(t){e&&e.listCodingjobs().then((function(e){n(O(null)),n(x(e))})),i("inactive")})).catch((function(e){console.log(e),i("error")}))},open:"inactive"!==c,onClose:function(){return i("inactive")},onOpen:function(){j(""),i("awaiting input")},size:"tiny",children:[Object(D.jsx)(m.a,{icon:"pencil",content:"Create new Codingjob",as:"h2"}),Object(D.jsx)(v.a.Content,{children:Object(D.jsx)(ve.a.Group,{children:Object(D.jsx)(ve.a.Input,{width:12,label:"Name",required:!0,type:"text",value:d,onChange:function(e,t){i("awaiting input"),j(t.value)},placeholder:"Enter name"})})}),Object(D.jsxs)(v.a.Actions,{children:["error"===c?Object(D.jsx)("div",{children:"Could not create codingjob for a reason not yet covered in the error handling..."}):null,"pending"===c?Object(D.jsx)(me.a,{active:!0,inverted:!0,children:Object(D.jsx)(ye.a,{content:"Creating codingjob"})}):Object(D.jsx)(y.a,{type:"submit",color:"green",icon:"save",content:"Create"})]})]}):null},ke=function(){var e=Object(u.c)((function(e){return e.db})),t=Object(u.c)((function(e){return e.codingjob})),n=Object(u.b)(),o=Object(r.useState)("inactive"),a=Object(f.a)(o,2),c=a[0],i=a[1],s=function(r){i("pending"),e.deleteCodingjob(t).then((function(t){e&&e.listCodingjobs().then((function(e){n(O(null)),n(x(e))})),i("inactive")})).catch((function(e){console.log(e.message),console.log(e),i("error")}))};return t?Object(D.jsxs)(v.a,{closeIcon:!0,open:"inactive"!==c,trigger:Object(D.jsxs)(y.a,{name:"logout",children:[Object(D.jsx)(L.a,{name:"minus"})," Delete job"]}),onClose:function(){i("inactive")},onOpen:function(){i("awaiting input")},children:[Object(D.jsx)(m.a,{icon:"trash",content:"Delete codingjob ".concat(t.name)}),Object(D.jsx)(v.a.Content,{children:Object(D.jsx)("p",{children:"Do you really want to delete this codingjob?"})}),Object(D.jsxs)(v.a.Actions,{children:["error"===c?Object(D.jsx)("div",{children:"Could not delete codingjob for a reason not yet covered in the error handling..."}):null,"pending"===c?Object(D.jsx)(me.a,{active:!0,inverted:!0,children:Object(D.jsx)(ye.a,{content:"Creating codingjob"})}):Object(D.jsxs)(D.Fragment,{children:[Object(D.jsxs)(y.a,{color:"red",onClick:s,children:[Object(D.jsx)(L.a,{name:"remove"})," No"]}),Object(D.jsxs)(y.a,{color:"green",onClick:s,children:[Object(D.jsx)(L.a,{name:"checkmark"})," Yes"]})]})]})]}):null},Ce=function(e){var t,n=e.type,o=void 0===n?"table":n,a=Object(u.c)((function(e){return e.db})),c=Object(u.c)((function(e){return e.codingjobs})),i=Object(u.c)((function(e){return e.codingjob})),s=Object(u.b)(),l=Object(r.useState)(i),d=Object(f.a)(l,2),j=d[0],b=d[1];if(Object(r.useEffect)((function(){s(O(j))}),[i,j,s]),Object(r.useEffect)((function(){a&&i&&a.listDocuments(i).then((function(e){s(function(e){return{type:"SET_DOCUMENTS",payload:e}}(e))})).catch((function(e){console.log(e)}))}),[a,i,s]),Object(r.useEffect)((function(){a&&null===c&&a.listCodingjobs().then((function(e){s(x(e)),e.length>0&&b(Object(te.a)(Object(te.a)({},e[0]),{},{ROW_ID:"0"}))}))}),[a,c,s]),"table"===o){return Object(D.jsxs)(ce.a,{style:{border:"0"},children:[Object(D.jsxs)(y.a.Group,{widths:"2",children:[Object(D.jsx)(we,{}),Object(D.jsx)(ke,{})]}),Object(D.jsx)($.a,{style:{marginTop:"30px"},children:Object(D.jsx)(ge,{columns:[{Header:"Select Index",accessor:"name",headerClass:"thirteen wide"}],data:c||[],selectedRow:j,setSelectedRow:b,defaultSize:15})})]})}if("dropdown"===o){return Object(D.jsx)(le.a,{clearable:!0,selection:!0,options:(t=c,t.map((function(e){return{key:e.name,text:e.name,value:e.name}}))),value:i?i.name:null,onChange:function(e,t){return function(e){if(e&&null!==c){var t=c.findIndex((function(t){return t.name===e}));b(Object(te.a)(Object(te.a)({},c[t]),{},{ROW_ID:t.toString()}))}else b(null)}(t.value)}})}return null},Se=[{Header:"title",accessor:"title",headerClass:"six wide"},{Header:"text",accessor:"text",headerClass:"four wide"},{Header:"annotations",accessor:"annotations",headerClass:"four wide"},{Header:"meta",accessor:"meta",headerClass:"four wide"}],Ee=function(){var e=Object(u.c)((function(e){return e.codingjob})),t=Object(u.c)((function(e){return e.document})),n=Object(u.c)((function(e){return e.documents})),o=Object(u.b)(),a=Object(r.useState)(t),c=Object(f.a)(a,2),i=c[0],s=c[1];return Object(r.useEffect)((function(){o(function(e){return{type:"SELECT_ARTICLE",payload:e}}(i))}),[i,o]),e?Object(D.jsx)(ge,{columns:Se,data:n,selectedRow:i,setSelectedRow:s,defaultSize:15}):null},Te=function(){return Object(D.jsx)($.a,{style:{marginTop:"2em"},children:Object(D.jsx)(Ee,{})})},_e=n(505),Ae=n(296),De=function(e){var t=e.data,n=e.codingjob,o=e.fileRef,a=Object(u.c)((function(e){return e.db})),c=Object(r.useState)([]),i=Object(f.a)(c,2),s=i[0],l=i[1],d=Object(r.useState)(null),p=Object(f.a)(d,2),h=p[0],O=p[1],x=Object(r.useState)(null),g=Object(f.a)(x,2),v=g[0],m=g[1],w=Object(r.useState)(null),k=Object(f.a)(w,2),C=k[0],S=k[1];Object(r.useEffect)((function(){if(t.length<=1)return O(null),m(null),S(null),void l([]);l(t[0].data.map((function(e){return{key:e,value:e,text:e}}))),O(t[0].data.includes("title")?"title":null),m(t[0].data.includes("text")?"text":null),S(t[0].data.includes("annotations")?"annotations":null)}),[t]);var E=function(e,t,n,r){var o=e[0].data;return e.slice(1).map((function(e){var a=e.data.reduce((function(e,a,c){var i=o[c];return i===t?e.title=a:i===n?e.text=a:i===r?e.annotations=a:e.meta[i]=a,e}),{meta:{},annotations:""});return a.meta=JSON.stringify(a.meta,null,2),a}))},T=function(){var e=Object(b.a)(j.a.mark((function e(){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=E(t,h,v,C),e.next=4,a.createDocuments(n,r);case 4:o.current.removeFile(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return t.length<=1?null:Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)(ve.a,{children:[Object(D.jsxs)(ve.a.Group,{children:[Object(D.jsx)(ve.a.Field,{control:_e.a,placeholder:"title column",options:s,value:h,onChange:function(e,t){return O(t.value)}}),Object(D.jsx)(ve.a.Field,{control:_e.a,placeholder:"text column",options:s,value:v,onChange:function(e,t){return m(t.value)}})]}),Object(D.jsxs)(ve.a.Group,{children:[Object(D.jsx)(ve.a.Field,{control:_e.a,clearable:!0,placeholder:"annotations (optional)",options:s,value:C,onChange:function(e,t){return S(t.value)}}),Object(D.jsxs)(ve.a.Field,{control:y.a,fluid:!0,onClick:T,disabled:!h||!v,children:[Object(D.jsx)(L.a,{name:"upload"}),"Upload"]})]})]})})},Ne=function(e){var t=e.data,n=function(e){return e.map((function(e){return Object(D.jsx)(pe.a.Cell,{children:Object(D.jsx)("span",{title:e,children:e})})}))};return t.length<=1?null:Object(D.jsxs)($.a,{style:{marginTop:"2em"},children:[Object(D.jsxs)(pe.a,{fixed:!0,singleLine:!0,basic:"very",children:[Object(D.jsx)(pe.a.Header,{children:Object(D.jsx)(pe.a.Row,{children:function(e){return e[0].data.map((function(e){return Object(D.jsx)(pe.a.HeaderCell,{children:Object(D.jsx)("span",{title:e,children:e})})}))}(t)})}),Object(D.jsx)(pe.a.Body,{children:function(e,t){return e.slice(0,t+1).slice(1).map((function(e){return Object(D.jsx)(pe.a.Row,{children:n(e.data)})}))}(t,5)})]}),t.length>5?Object(D.jsxs)(m.a,{align:"center",children:[t.length-1-5," more rows"]}):null]})},Re=function(e){e.setActive;var t=Object(u.c)((function(e){return e.codingjob})),n=Object(r.useState)([]),o=Object(f.a)(n,2),a=o[0],c=o[1],i=Object(r.useRef)();return t?Object(D.jsxs)(ae.a,{style:{marginTop:"4.3em"},children:[Object(D.jsxs)(ae.a.Row,{children:[Object(D.jsxs)(ae.a.Column,{floated:"right",width:4,children:[" ",Object(D.jsx)(Ae.a,{ref:i,onFileLoad:function(e){return c(e)},addRemoveButton:!0,onRemoveFile:function(){return c([])},children:Object(D.jsx)("span",{children:"Click to upload"})})]}),Object(D.jsx)(ae.a.Column,{floated:"right",width:10,children:Object(D.jsx)(De,{data:a,codingjob:t,fileRef:i})})]}),Object(D.jsx)(ae.a.Row,{children:Object(D.jsx)(ae.a.Column,{children:Object(D.jsx)(Ne,{data:a})})})]}):null},Ie=n(302),Fe=(n(484),function(e){var t=e.fields,n=e.fieldValues,r=e.setFieldValues,o=function(e,t){var o=Object(te.a)({},n);o[e]=t,r(o)};return t?Object.keys(t).map((function(e){return"text"===t[e]?Object(D.jsx)(ve.a.TextArea,{value:n[e]?n[e]:"",onChange:function(t,n){return o(e,n.value)},label:e},e):"date"===t[e]?Object(D.jsx)(ve.a.Field,{children:Object(D.jsx)(Ie.a,{label:e,value:n[e]?n[e]:"",onChange:function(t,n){return o(e,n.value)}},e)}):"keyword"===t[e]?Object(D.jsxs)(ve.a.Field,{children:[Object(D.jsx)("label",{children:e}),Object(D.jsx)("input",{value:n[e]?n[e]:"",onChange:function(t){return o(e,t.target.value)}})]},e):null})):null}),Be=function(){var e=Object(u.c)((function(e){return e.db})),t=Object(u.c)((function(e){return e.codingjob})),n=Object(r.useState)({}),o=Object(f.a)(n,2),a=o[0],c=o[1];return t?Object(D.jsxs)(ve.a,{style:{marginTop:"3em"},children:[Object(D.jsx)(Fe,{fields:{title:"text",text:"text",annotations:"text"},fieldValues:a,setFieldValues:c}),t?Object(D.jsx)(y.a,{primary:!0,onClick:function(){for(var n=Object(te.a)({},a),r=0,o=Object.keys(n);r<o.length;r++){var i=o[r];("date"===i||/_date$/.test(i))&&(n[i]=n[i].toISOString())}e.createDocuments(t,[n]).then((function(e){c({})})).catch((function(e){console.log(e)}))},children:"Create document"}):null]}):null},Pe=function(){var e=Object(r.useState)("details"),t=Object(f.a)(e,2),n=t[0],o=t[1];return Object(D.jsxs)(ae.a,{style:{marginTop:"3em"},children:[Object(D.jsx)(ae.a.Column,{floated:"left",width:5,children:Object(D.jsx)(Ce,{type:"table"})}),Object(D.jsx)(ae.a.Column,{width:11,children:Object(D.jsxs)(ce.a,{style:{border:0},children:[Object(D.jsxs)(l.a,{pointing:!0,secondary:!0,children:[Object(D.jsx)(l.a.Item,{name:"details",active:"details"===n,onClick:function(e,t){return o(t.name)}}),Object(D.jsx)(l.a.Item,{name:"upload",active:"upload"===n,onClick:function(e,t){return o(t.name)}}),Object(D.jsx)(l.a.Item,{name:"create",active:"create"===n,onClick:function(e,t){return o(t.name)}})]}),function(e){switch(e){case"details":return Object(D.jsx)(Te,{});case"upload":return Object(D.jsx)(Re,{});case"create":return Object(D.jsx)(Be,{});default:return null}}(n)]})})]})},Ge=n(175),Le=function(){var e=Object(b.a)(j.a.mark((function e(t,n,r){var o,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new Set,a=Object.values(r).reduce((function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var a=r[n],c={code:a,offset:t[a].offset,length:t[a].length},i=JSON.stringify(c);o.has(i)||(o.add(i),e.push(c))}return e}),[]),e.next=4,t.writeValue({doc_id:n.doc_id},"annotations",JSON.stringify(a,null,2));case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Je=function(e,t,n){var r,o={},a=[],c=Object(Ge.a)(e);try{for(c.s();!(r=c.n()).done;){var i=r.value;ze(i,t,o,a)}}catch(l){c.e(l)}finally{c.f()}for(var s=0,u=a;s<u.length;s++){He(u[s],n)}},ze=function(e,t,n,r){for(var o=e.offset.start,a=e.offset.start+e.offset.length,c=o;c<=a;c++)if(t[c]){var i,s=Object(Ge.a)(t[c].start);try{for(s.s();!(i=s.n()).done;){var u=i.value;n[u]={index:e.offset.index,group:u,offset:o,length:null,span:[e.offset.index]}}}catch(b){s.e(b)}finally{s.f()}var l,d=Object(Ge.a)(t[c].end);try{for(d.s();!(l=d.n()).done;){var j=l.value;n[j].span.push(e.offset.index),n[j].length=e.offset.start+e.offset.length-n[j].offset,r.push(n[j]),delete n[j]}}catch(b){d.e(b)}finally{d.f()}}},He=function(e,t){for(var n=[],r=e.span[0];r<=e.span[1];r++){var o=Object(te.a)({},e);o.index=r,n.push(o)}t(g(n))},Me=function(e){var t=e.tokens,n=e.doc,o=Object(u.c)((function(e){return e.db})),a=Object(u.c)((function(e){return e.spanAnnotations})),c=Object(r.useState)(!1),i=Object(f.a)(c,2),s=i[0],l=i[1],d=Object(u.b)();return Object(r.useEffect)((function(){l(!1)}),[n]),Object(r.useEffect)((function(){t&&n.annotations&&(Je(t,n.annotations,d),l(!0))}),[t,n,d]),Object(r.useEffect)((function(){s&&Le(o,n,a)}),[s,o,n,a]),Object(D.jsx)("div",{})},Ue=(n(485),n(301)),Ve=n(509),qe=n(513),Ye=n(515),Ke=n(299),We=n.n(Ke),Xe=function(e){var t=e.index,n=e.children,o=Object(u.c)((function(e){return e.codes})),a=Object(u.c)((function(e){return e.codeHistory})),c=Object(u.c)((function(e){return e.spanAnnotations})),i=Object(r.useRef)(null),s=Object(r.useState)(null),l=Object(f.a)(s,2),d=l[0],j=l[1],b=!0,p=Object(u.b)();Object(r.useEffect)((function(){var e=c[t];e&&void 0!==e&&(Object.keys(e).includes("Not yet assigned")?j("Not yet assigned"):j(Object.keys(e)[0]))}),[t,c]);var h=function(e){e?window.addEventListener("keydown",O):window.removeEventListener("keydown",O)},O=function(e){i.current&&i.current.click()},x=function(e,t){var n=t.find((function(t){return t.value===e}));return n?n.color:"lightgrey"},v=function(e){var n=d,r=c[t];if(!r)return null;var o={index:r[n].index,group:n,offset:r[n].offset,length:r[n].length,span:r[n].span},a=Object(te.a)({},o);if(a.span=[a.index,a.index],p({type:"RM_ANNOTATIONS",payload:[a]}),e===n)return null;for(var i=[],s=o.span[0];s<=o.span[1];s++){var u=Object(te.a)({},o);u.group=e,u.index=s,i.push(u)}p(g(i)),p(function(e){return{type:"APPEND_CODE_HISTORY",payload:{code:e,n:arguments.length>1&&void 0!==arguments[1]?arguments[1]:5}}}(e)),Object.keys(r).includes(null)?j(null):j(e)},m=function(e){var t=e;return e&&"null"!==e||(t="Not yet assigned"),{key:t,text:t,value:t}};return Object(D.jsx)(Ve.a,{trigger:n,on:"hover",flowing:!0,hoverable:!0,wide:!0,onOpen:function(){return h(!0)},onClose:function(){return h(!1)},position:"top left",children:Object(D.jsx)("div",{children:Object(D.jsxs)(qe.a.Group,{vertical:!0,children:[Object(D.jsx)(qe.a,{active:!0,children:Object(D.jsxs)(qe.a.Content,{children:[Object(D.jsx)(qe.a.Title,{children:"Current code"}),Object(D.jsx)(qe.a.Description,{children:Object(D.jsxs)(y.a.Group,{children:[Object(D.jsx)(y.a,{icon:"trash",size:"mini",onClick:function(e,t){return v(d)}}),Object(D.jsx)(y.a,{style:{backgroundColor:x(d,o)},children:Object(D.jsx)(le.a,{text:d,options:function(){var e=c[t];return e?Object.keys(e).filter((function(e){return e!==d})).map(m):[m(null)]}(),value:d,onChange:function(e,t){return j(t.value)}})})]})})]})}),Object(D.jsx)(qe.a,{children:Object(D.jsxs)(qe.a.Content,{children:[Object(D.jsx)(qe.a.Title,{children:"Set new code"}),Object(D.jsxs)(qe.a.Description,{children:[Object(D.jsx)(y.a.Group,{vertical:!0,compact:!0,widths:"1",children:a.filter((function(e){return e!==d&&"Not yet assigned"!==e})).map((function(e){return Object(D.jsx)(y.a,{style:{backgroundColor:x(e,o)},value:e,onClick:function(e,t){return v(t.value)},children:e},e)}))}),"\xa0\xa0",Object(D.jsx)(Ye.a,{innerRef:i,children:Object(D.jsx)(le.a,{compact:!0,options:o,placeholder:b?"Search or create ":"Search ",widths:1,search:!0,selection:!0,allowAdditions:b,additionPosition:"bottom",onAddItem:function(e,t){p(function(e){return{type:"SET_CODES",payload:e}}([{key:t.value,text:t.value,value:t.value,color:We()({seed:t.value,luminosity:"bright"})}].concat(Object(Ue.a)(o))))},selectOnNavigation:!1,minCharacters:0,autoComplete:"on",searchInput:{autoFocus:!1},onChange:function(e,t){return v(t.value)}})})]})]})})]})})})},Ze=function(e){var t=e.token;return Object(D.jsx)("span",{className:"token",tokenindex:t.offset.index,tokenoffset:t.offset.start,tokenlength:t.offset.length,children:Object(D.jsx)($e,{token:t})})},$e=o.a.memo((function(e){var t=e.token,n=Object(u.c)((function(e){return e.spanAnnotations[t.offset.index]})),r=Object(u.c)((function(e){return e.codes}));if(Object(u.c)((function(e){return JSON.stringify(e.spanAnnotations[t.offset.index])})),!n)return Object(D.jsx)(D.Fragment,{children:t.pre+t.text+t.post});var o=function(e,t){var n=t.find((function(t){return t.value===e}));return n?n.color:"lightgrey"},a=Object.keys(n),c=null;if(1===a.length)c=o(a[0],r);else{var i=a.map((function(e){return o(e,r)}));c="linear-gradient(".concat(i.join(", "),")")}var s=!Object.values(n).some((function(e){return e.span[0]!==e.index})),l=!Object.values(n).some((function(e){return e.span[1]!==e.index})),d="TextCodeBubble";return s&&(d+=" allLeft"),Object.values(n).some((function(e){return e.span[0]===e.index}))&!s&&(d+=" anyLeft"),l&&(d+=" allRight"),Object.values(n).some((function(e){return e.span[1]===e.index}))&!l&&(d+=" anyRight"),Object(D.jsxs)(D.Fragment,{children:[s?t.pre:null,Object(D.jsx)(Xe,{index:t.offset.index,children:Object(D.jsxs)("span",{className:d,style:{background:c},children:[s&&l?t.text:null,s&&!l?t.text+t.post:null,l&&!s?t.pre+t.text:null,s||l?null:t.pre+t.text+t.post]})}),l?t.post:null]})})),Qe=o.a.memo(Ze),et=n(216),tt=n(300);et.a.extend(tt.a);var nt=function(e){var t=e.text,n=e.setTokens,o=Object(r.useState)(null),a=Object(f.a)(o,2),c=a[0],i=a[1];return Object(r.useEffect)((function(){var e=rt(t),r=Object(f.a)(e,2),o=r[0],a=r[1];i(o),n(a)}),[t,n]),null===t?null:Object(D.jsx)($.a,{text:!0,children:c})},rt=function(e){var t=[];return[et.a.tokenize(e).paragraphs().json({offset:!0}).map((function(e,n){return ot(e,n,t)})),t]},ot=function(e,t,n){var r=function(e){return e.sentences.map((function(e){return e.map((function(e){return at(e,n)}))}))};return Object(D.jsx)("span",{style:{marginTop:"1em",display:"table"},children:0===t?Object(D.jsx)("h2",{children:r(e)}):r(e)},t)},at=function(e,t){return Object(D.jsx)("span",{className:"sentence",children:function(e){return e.terms.map((function(e){return t.push(e),Object(D.jsx)(Qe,{token:e},e.offset.index)}))}(e)},e.offset.index)},ct=o.a.memo(nt),it=function(e){return{index:parseInt(e.getAttribute("tokenindex")),offset:parseInt(e.getAttribute("tokenoffset")),length:parseInt(e.getAttribute("tokenlength"))}},st=function(e){return console.log(e),"token"===e.className?it(e):e.parentNode&&"token"===e.parentNode.className?it(e.parentNode):null},ut=function(e){var t=e.doc,n=Object(u.c)((function(e){return e.codeHistory})),o=Object(r.useState)([]),a=Object(f.a)(o,2),c=a[0],i=a[1],s=Object(u.b)();Object(r.useEffect)((function(){s({type:"CLEAR_SPAN_ANNOTATIONS"})}),[t,s]),Object(r.useEffect)((function(){return window.addEventListener("keydown",l),function(){window.removeEventListener("keydown",l)}})),Object(r.useEffect)((function(){return window.addEventListener("mouseup",d),function(){window.removeEventListener("mouseup",d)}}));var l=function(e){console.log(e.key)},d=function(e){if(1!==e.which)return null;e.preventDefault();var t=window.getSelection();if(!t.anchorNode||!t.focusNode)return null;var r=st(t.anchorNode.parentElement),o=st(t.focusNode.parentElement);if(!r||!o)return null;if(window.getSelection().empty(),r.index>o.index){var a=[o,r];r=a[0],o=a[1]}var c=n[0]?n[0]:null;e.ctrlKey||(c="Not yet assigned");for(var i=[],u=r.index;u<=o.index;u++)i.push({index:u,group:c,offset:r.offset,length:o.offset+o.length-r.offset,span:[r.index,o.index]});s(g(i))};return t?Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(ct,{text:t.text,setTokens:i}),Object(D.jsx)(Me,{tokens:c,doc:t})]}):null},lt="/amcat4annotator",dt=[{label:"Create",path:lt+"/create",Component:Pe},{label:"Annotate",path:lt+"/annotate",Component:function(){var e=Object(u.c)((function(e){return e.db})),t=Object(u.c)((function(e){return e.codingjob})),n=Object(r.useState)(null),o=Object(f.a)(n,2),a=o[0],c=o[1],i=Object(r.useState)([]),s=Object(f.a)(i,2),l=s[0],d=s[1];Object(r.useEffect)((function(){e&&t&&e.listDocuments(t).then((function(e){d(e)})).catch((function(e){console.log(e)}))}),[e,t]);var p=function(){var t=Object(b.a)(j.a.mark((function t(n){var r;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getDocument(n);case 2:r=t.sent,c({doc_id:r.doc_id,text:r.title+"\n\n"+r.text,annotations:(o=r.annotations,o&&""!==o?JSON.parse(o).reduce((function(e,t){return e[t.offset]||(e[t.offset]={start:[],end:[]}),e[t.offset+t.length]||(e[t.offset+t.length]={start:[],end:[]}),e[t.offset].start.push(t.code),e[t.offset+t.length].end.push(t.code),e}),{}):{})});case 4:case"end":return t.stop()}var o}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(D.jsx)(D.Fragment,{children:Object(D.jsxs)(ae.a,{children:[Object(D.jsxs)(ae.a.Row,{children:[Object(D.jsx)(Ce,{type:"dropdown"}),Object(D.jsx)(le.a,{selection:!0,onChange:function(e,t){p(t.value)},options:function(e){return e.map((function(e,t){return{key:t,text:e.title,value:e.doc_id}}))}(l)})]}),Object(D.jsxs)(ae.a.Row,{children:[Object(D.jsx)(ae.a.Column,{width:12,children:Object(D.jsx)(ut,{doc:a||null})}),Object(D.jsx)(ae.a.Column,{width:4,children:Object(D.jsx)(Xe,{})})]})]})})}}],jt=function(){var e;return Object(D.jsxs)(i.a,{children:[Object(D.jsx)(X,{items:dt,homepage:lt}),Object(D.jsx)(Z.a,{}),Object(D.jsx)($.a,{style:{marginTop:"3em"},children:Object(D.jsxs)(s.d,{children:[Object(D.jsx)(s.b,{exact:!0,path:lt,render:function(){return Object(D.jsx)(ie,{items:dt})}}),(e=dt,e.map((function(e){return Object(D.jsx)(ue,{path:e.path,homepage:lt,Component:e.Component},e.path)})))]})})]})},bt=n(92),ft=function(e,t,n){for(var r in t){var o=t[r];if(e[o.index]&&e[o.index][o.group]){for(var a=e[o.index][o.group].span,c=a[0];c<=a[1];c++)e[c]&&e[c][o.group]&&(delete e[c][o.group],0===Object.keys(e[c]).length&&delete e[c]);if(o.span[0]===o.span[1])continue}n||(e[o.index]||(e[o.index]={}),e[o.index][o.group]={index:o.index,span:[o.span[0],o.span[1]],offset:o.offset,length:o.length})}return e},pt=[{key:"Mark Rutte",text:"Mark Rutte",value:"Mark Rutte",color:"#40a31f"},{key:"Sigrid Kaag",text:"Sigrid Kaag",value:"Sigrid Kaag",color:"#f2db5c"}],ht=Object(bt.b)({db:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DB":return t.payload;case"RESET_DB":return null;default:return e}},dropbox:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DROPBOX":return console.log("set dropbox"),t.payload;case"RESET_DB":return null;default:return e}},codingjob:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_CODINGJOB":return t.payload;case"RESET_DB":return null;default:return e}},codingjobs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CODINGJOBS":return t.payload;case"RESET_DB":return null;default:return e}},document:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_DOCUMENT":return t.payload;case"RESET_DB":return[];default:return e}},documents:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_DOCUMENTS":return t.payload;case"RESET_DB":return[];default:return e}},tokenIndices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_TOKEN_INDICES":return t.payload;case"RESET_DB":return null;default:return e}},spanAnnotations:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"TOGGLE_ANNOTATIONS":return ft(Object(te.a)({},e),t.payload,!1);case"RM_ANNOTATIONS":return ft(Object(te.a)({},e),t.payload);case"CLEAR_SPAN_ANNOTATIONS":case"RESET_DB":return{};default:return e}},codes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CODES":return t.payload;case"RESET_DB":return[];default:return e}},codeHistory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"APPEND_CODE_HISTORY":var n=e.filter((function(e){return e!==t.payload.code})).slice(0,t.payload.n-1);return n.unshift(t.payload.code),n;case"RESET_DB":return[];default:return e}}}),Ot=Object(bt.c)(ht);c.a.render(Object(D.jsx)(o.a.StrictMode,{children:Object(D.jsx)(u.a,{store:Ot,children:Object(D.jsx)(jt,{})})}),document.querySelector("#root"))}},[[486,1,2]]]);
//# sourceMappingURL=main.95b9061d.chunk.js.map